<!doctype html>
<html>
    <head>
                <title>Simulai io - SimulAI's Documentation</title>

            <meta charset="utf-8">
            <meta http-equiv="X-UA-Compatible" content="IE=edge">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">

            
            
            

            
                <link  rel="icon" type="image/x-icon" href="../assets/img/favicon.ico">
            
                    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.5.0/highlight.min.js"></script>
                        <script>hljs.initHighlightingOnLoad();</script>
            <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Fira+Mono:400,700">
            <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
            <link rel="stylesheet" href="../assets/css/bootstrap.min.css">
            <link rel="stylesheet" href="../assets/css/main.min.css">
                <link href="../assets/_mkdocstrings.css" rel="stylesheet">
                <script src="../search/main.js"></script>

            
                
            
    </head>

    <body>
        <div class="container py-3">
            <header>
                    <!-- block header -->
<nav class="navbar navbar-expand-xl border-bottom">
    <div class="container-fluid">
        

        
            <span class="normal fs-4 title-color site-name" id="component-site-name" style="text-transform: uppercase;">SimulAI's Documentation</span>
        

        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarsMenu"
            aria-controls="navbarsMenu" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse flex-column ml-auto" id="navbarsMenu">
            <ul class="navbar-nav">

                <!-- block menu -->
                <li class="nav-item">
                    <!-- block menu -->
    
        <li class="nav-item" id="component-menu">
            <ul class="navbar-nav">
                        <li class="nav-item">
                            <a class="
                            nav-link text-gray text-decoration-none" href="..">[Home]</a>
                        </li>
                        <li class="nav-item dropdown">
                            <a class=" active 
                            nav-link dropdown-toggle text-decoration-none" href="#" data-bs-toggle="dropdown">[Modules]</a>
                            <ul class="dropdown-menu">
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">IO &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="./" class="dropdown-item text-decoration-none  active ">Simulai io</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">File &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_file/" class="dropdown-item text-decoration-none ">Simulai file</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Batching &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_batching/" class="dropdown-item text-decoration-none ">Simulai batching</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Activations &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_activations/" class="dropdown-item text-decoration-none ">Simulai activations</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Parallel &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_parallel/" class="dropdown-item text-decoration-none ">Simulai parallel</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                            </ul>
                        </li>
                        <li class="nav-item dropdown">
                            <a class="
                            nav-link dropdown-toggle text-decoration-none" href="#" data-bs-toggle="dropdown">[Subpackages]</a>
                            <ul class="dropdown-menu">
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Symbolic Manipulation &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_residuals/" class="dropdown-item text-decoration-none ">Simulai residuals</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Regression/Neural Networks &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Dense Networks &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_regression/simulai_dense/" class="dropdown-item text-decoration-none ">Simulai dense</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">OpInf &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_regression/simulai_opinf/" class="dropdown-item text-decoration-none ">Simulai opinf</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">ROM &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_rom/simulai_rom/" class="dropdown-item text-decoration-none ">Simulai rom</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Models &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Transformer &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_models/simulai_models_transformer/" class="dropdown-item text-decoration-none ">Simulai models transformer</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">DeepONet &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_models/simulai_models_deeponet/" class="dropdown-item text-decoration-none ">Simulai models deeponet</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">AutoEncoder &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_models/simulai_models_autoencoder/" class="dropdown-item text-decoration-none ">Simulai models autoencoder</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">U-Net &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_models/simulai_models_unet/" class="dropdown-item text-decoration-none ">Simulai models unet</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                                    <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Optimization &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Optimization Interfaces &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_optimization/simulai_optimizer/" class="dropdown-item text-decoration-none ">Optimization Interfaces</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                <!-- block dropdown-menu -->
    <li>
        <a class="dropdown-item text-decoration-none" href="#">Loss Functions &raquo;</a>
        <ul class="submenu dropdown-menu">
                <!-- block dropdown-menu -->
    <li>
        <a href="../simulai_optimization/simulai_losses/" class="dropdown-item text-decoration-none ">Loss Functions</a>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
        </ul>
    </li>
<!-- endblock -->
                            </ul>
                        </li>
            </ul>
        </li>
<!-- endblock -->
                </li>
                <!-- endblock -->

                <!-- block search -->
                <li class="nav-item">
                    <a class="collapsed" data-bs-toggle="collapse" href="#collapseExample" role="button" aria-expanded="false" aria-controls="collapseExample">
                        <div class="md-search-icon">
                            <i class="fa fa-search" aria-hidden="true"></i>
                        </div>
                    </a>
                </li>
                <!--  endblock -->

                <!-- block source -->
                <li class="nav-item">
                    
                        
                            <!-- block source -->
<div class="md-source source-detail">
  <div class="md-source-repo-icon">
    <i class="fa fa-github-alt" aria-hidden="true"></i>
  </div>

  <div class="md-source-repo-url">
    <a href="https://github.com/IBM/simulai" class="md-source">
      IBM/simulai
    </a>

    <ul class="md-source-repo-text">
      <li>
        <i class="fa fa-tag" aria-hidden="true"></i>
        <img alt="GitHub tag (latest by date)"
          src="https://img.shields.io/github/v/tag/IBM/simulai?color=white&label=%20&style=flat-square">
      </li>

      <li>
        <i class="fa fa-star" aria-hidden="true"></i>
        <img alt="GitHub Repo stars"
          src="https://img.shields.io/github/stars/IBM/simulai?color=white&label=%20&style=flat-square">
      </li>

      <li>
        <i class="fa fa-code-fork" aria-hidden="true"></i>
        <img alt="GitHub forks"
          src="https://img.shields.io/github/forks/IBM/simulai?color=white&label=%20&style=flat-square">
      </li>
    </ul>
  </div>

</div>
<!--  endblock -->
                        
                    
                </li>
                <!--  endblock -->
            </ul>
        </div>
    </div>
</nav>
<!--  endblock -->
            </header>

            <main><!-- block search -->
<div class="collapse" id="collapseExample">
    <div role="search" class="search-box">
        <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
            <input type="text" name="q" class="search-query"
            placeholder="Search docs" title="Type search term here" />
        </form>
    </div>
</div>
<!-- endblock -->
                    <!-- block content -->
<section class="container post">
    <article>
        <header>
            
                <h1 class="bold title" id="component-title">Simulai io</h1>
            
        </header>
        <p><style>
red { color: red }
</style>

<h1 id="simulaiio"><red>simulai.io</red><a class="headerlink" href="#simulaiio" title="Permanent link">#</a></h1>
<h2 id="bypasspreparer"><red>ByPassPreparer</red><a class="headerlink" href="#bypasspreparer" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.ByPassPreparer"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="simulai.abstract.DataPreparer">DataPreparer</span></code></p>

  
      <p>ByPass class, it fills the DataPreparer blank, but does nothing.</p>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 37</span>
<span class="normal"> 38</span>
<span class="normal"> 39</span>
<span class="normal"> 40</span>
<span class="normal"> 41</span>
<span class="normal"> 42</span>
<span class="normal"> 43</span>
<span class="normal"> 44</span>
<span class="normal"> 45</span>
<span class="normal"> 46</span>
<span class="normal"> 47</span>
<span class="normal"> 48</span>
<span class="normal"> 49</span>
<span class="normal"> 50</span>
<span class="normal"> 51</span>
<span class="normal"> 52</span>
<span class="normal"> 53</span>
<span class="normal"> 54</span>
<span class="normal"> 55</span>
<span class="normal"> 56</span>
<span class="normal"> 57</span>
<span class="normal"> 58</span>
<span class="normal"> 59</span>
<span class="normal"> 60</span>
<span class="normal"> 61</span>
<span class="normal"> 62</span>
<span class="normal"> 63</span>
<span class="normal"> 64</span>
<span class="normal"> 65</span>
<span class="normal"> 66</span>
<span class="normal"> 67</span>
<span class="normal"> 68</span>
<span class="normal"> 69</span>
<span class="normal"> 70</span>
<span class="normal"> 71</span>
<span class="normal"> 72</span>
<span class="normal"> 73</span>
<span class="normal"> 74</span>
<span class="normal"> 75</span>
<span class="normal"> 76</span>
<span class="normal"> 77</span>
<span class="normal"> 78</span>
<span class="normal"> 79</span>
<span class="normal"> 80</span>
<span class="normal"> 81</span>
<span class="normal"> 82</span>
<span class="normal"> 83</span>
<span class="normal"> 84</span>
<span class="normal"> 85</span>
<span class="normal"> 86</span>
<span class="normal"> 87</span>
<span class="normal"> 88</span>
<span class="normal"> 89</span>
<span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span>
<span class="normal">112</span>
<span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ByPassPreparer</span><span class="p">(</span><span class="n">DataPreparer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;ByPass class, it fills the DataPreparer blank, but does nothing.&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;no_preparer&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">channels_last</span> <span class="o">=</span> <span class="n">channels_last</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collapsible_shapes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare input data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray):</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray:</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; data = np.random.rand(5, 3, 4, 2)</span>
<span class="sd">            &gt;&gt;&gt; preparer = ByPassPreparer()</span>
<span class="sd">            &gt;&gt;&gt; prepared_data = preparer.prepare_input_data(data)</span>
<span class="sd">            &gt;&gt;&gt; prepared_data.shape</span>
<span class="sd">            (5, 3, 4, 2)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collapsible_shapes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">prepare_output_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare output data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray):</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray: The output data in the original format</span>

<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; data = np.random.rand(5, 3)</span>
<span class="sd">            &gt;&gt;&gt; preparer = ByPassPreparer()</span>
<span class="sd">            &gt;&gt;&gt; prepared_data = preparer.prepare_output_data(data)</span>
<span class="sd">            &gt;&gt;&gt; prepared_data.shape</span>
<span class="sd">            (5, 3)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare structured input data by converting it to an ndarray.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.recarray):</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: numpy ndarray version of the input data.</span>

<span class="sd">        Note:</span>
<span class="sd">            This function is used when the input data is in the form of a structured array and needs to be converted to a regular numpy ndarray.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; data = np.array([(1, &#39;a&#39;, 0.5), (2, &#39;b&#39;, 0.6)], dtype=[(&#39;a&#39;, int), (&#39;b&#39;, &#39;|S1&#39;), (&#39;c&#39;, float)])</span>
<span class="sd">            &gt;&gt;&gt; preparer = ByPassPreparer()</span>
<span class="sd">            &gt;&gt;&gt; preparer.prepare_input_structured_data(data)</span>
<span class="sd">            array([[1, &#39;a&#39;, 0.5],</span>
<span class="sd">                   [2, &#39;b&#39;, 0.6]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">data</span>

    <span class="k">def</span> <span class="nf">prepare_output_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare structured output data by converting it to a recarray.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray):</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.recarray: numpy recarray version of the output data.</span>

<span class="sd">        Note:</span>
<span class="sd">            This function is used when the output data needs to be in the form of a structured array and is currently in the form of a regular numpy ndarray.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; data = np.array([[1, &#39;a&#39;, 0.5], [2, &#39;b&#39;, 0.6]])</span>
<span class="sd">            &gt;&gt;&gt; preparer = ByPassPreparer()</span>
<span class="sd">            &gt;&gt;&gt; preparer.prepare_output_structured_data(data)</span>
<span class="sd">            rec.array([(1, &#39;a&#39;, 0.5), (2, &#39;b&#39;, 0.6)],</span>
<span class="sd">            dtype=[(&#39;f0&#39;, &#39;&lt;i4&#39;), (&#39;f1&#39;, &#39;S1&#39;), (&#39;f2&#39;, &#39;&lt;f8&#39;)])</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.ByPassPreparer.prepare_input_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#simulai.io.ByPassPreparer.prepare_input_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare input data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>numpy.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data = np.random.rand(5, 3, 4, 2)
&gt;&gt;&gt; preparer = ByPassPreparer()
&gt;&gt;&gt; prepared_data = preparer.prepare_input_data(data)
&gt;&gt;&gt; prepared_data.shape
(5, 3, 4, 2)
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">49</span>
<span class="normal">50</span>
<span class="normal">51</span>
<span class="normal">52</span>
<span class="normal">53</span>
<span class="normal">54</span>
<span class="normal">55</span>
<span class="normal">56</span>
<span class="normal">57</span>
<span class="normal">58</span>
<span class="normal">59</span>
<span class="normal">60</span>
<span class="normal">61</span>
<span class="normal">62</span>
<span class="normal">63</span>
<span class="normal">64</span>
<span class="normal">65</span>
<span class="normal">66</span>
<span class="normal">67</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare input data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray):</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray:</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = np.random.rand(5, 3, 4, 2)</span>
<span class="sd">        &gt;&gt;&gt; preparer = ByPassPreparer()</span>
<span class="sd">        &gt;&gt;&gt; prepared_data = preparer.prepare_input_data(data)</span>
<span class="sd">        &gt;&gt;&gt; prepared_data.shape</span>
<span class="sd">        (5, 3, 4, 2)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">collapsible_shapes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.ByPassPreparer.prepare_input_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#simulai.io.ByPassPreparer.prepare_input_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare structured input data by converting it to an ndarray.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.recarray">recarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray: numpy ndarray version of the input data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>This function is used when the input data is in the form of a structured array and needs to be converted to a regular numpy ndarray.</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data = np.array([(1, 'a', 0.5), (2, 'b', 0.6)], dtype=[('a', int), ('b', '|S1'), ('c', float)])
&gt;&gt;&gt; preparer = ByPassPreparer()
&gt;&gt;&gt; preparer.prepare_input_structured_data(data)
array([[1, 'a', 0.5],
       [2, 'b', 0.6]])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 90</span>
<span class="normal"> 91</span>
<span class="normal"> 92</span>
<span class="normal"> 93</span>
<span class="normal"> 94</span>
<span class="normal"> 95</span>
<span class="normal"> 96</span>
<span class="normal"> 97</span>
<span class="normal"> 98</span>
<span class="normal"> 99</span>
<span class="normal">100</span>
<span class="normal">101</span>
<span class="normal">102</span>
<span class="normal">103</span>
<span class="normal">104</span>
<span class="normal">105</span>
<span class="normal">106</span>
<span class="normal">107</span>
<span class="normal">108</span>
<span class="normal">109</span>
<span class="normal">110</span>
<span class="normal">111</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare structured input data by converting it to an ndarray.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.recarray):</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: numpy ndarray version of the input data.</span>

<span class="sd">    Note:</span>
<span class="sd">        This function is used when the input data is in the form of a structured array and needs to be converted to a regular numpy ndarray.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = np.array([(1, &#39;a&#39;, 0.5), (2, &#39;b&#39;, 0.6)], dtype=[(&#39;a&#39;, int), (&#39;b&#39;, &#39;|S1&#39;), (&#39;c&#39;, float)])</span>
<span class="sd">        &gt;&gt;&gt; preparer = ByPassPreparer()</span>
<span class="sd">        &gt;&gt;&gt; preparer.prepare_input_structured_data(data)</span>
<span class="sd">        array([[1, &#39;a&#39;, 0.5],</span>
<span class="sd">               [2, &#39;b&#39;, 0.6]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.ByPassPreparer.prepare_output_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_output_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#simulai.io.ByPassPreparer.prepare_output_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare output data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>numpy.ndarray: The output data in the original format</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data = np.random.rand(5, 3)
&gt;&gt;&gt; preparer = ByPassPreparer()
&gt;&gt;&gt; prepared_data = preparer.prepare_output_data(data)
&gt;&gt;&gt; prepared_data.shape
(5, 3)
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">69</span>
<span class="normal">70</span>
<span class="normal">71</span>
<span class="normal">72</span>
<span class="normal">73</span>
<span class="normal">74</span>
<span class="normal">75</span>
<span class="normal">76</span>
<span class="normal">77</span>
<span class="normal">78</span>
<span class="normal">79</span>
<span class="normal">80</span>
<span class="normal">81</span>
<span class="normal">82</span>
<span class="normal">83</span>
<span class="normal">84</span>
<span class="normal">85</span>
<span class="normal">86</span>
<span class="normal">87</span>
<span class="normal">88</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_output_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare output data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray):</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: The output data in the original format</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = np.random.rand(5, 3)</span>
<span class="sd">        &gt;&gt;&gt; preparer = ByPassPreparer()</span>
<span class="sd">        &gt;&gt;&gt; prepared_data = preparer.prepare_output_data(data)</span>
<span class="sd">        &gt;&gt;&gt; prepared_data.shape</span>
<span class="sd">        (5, 3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.ByPassPreparer.prepare_output_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#simulai.io.ByPassPreparer.prepare_output_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare structured output data by converting it to a recarray.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.recarray">recarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.recarray: numpy recarray version of the output data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>This function is used when the output data needs to be in the form of a structured array and is currently in the form of a regular numpy ndarray.</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data = np.array([[1, 'a', 0.5], [2, 'b', 0.6]])
&gt;&gt;&gt; preparer = ByPassPreparer()
&gt;&gt;&gt; preparer.prepare_output_structured_data(data)
rec.array([(1, 'a', 0.5), (2, 'b', 0.6)],
dtype=[('f0', '&lt;i4'), ('f1', 'S1'), ('f2', '&lt;f8')])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">113</span>
<span class="normal">114</span>
<span class="normal">115</span>
<span class="normal">116</span>
<span class="normal">117</span>
<span class="normal">118</span>
<span class="normal">119</span>
<span class="normal">120</span>
<span class="normal">121</span>
<span class="normal">122</span>
<span class="normal">123</span>
<span class="normal">124</span>
<span class="normal">125</span>
<span class="normal">126</span>
<span class="normal">127</span>
<span class="normal">128</span>
<span class="normal">129</span>
<span class="normal">130</span>
<span class="normal">131</span>
<span class="normal">132</span>
<span class="normal">133</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_output_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare structured output data by converting it to a recarray.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray):</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.recarray: numpy recarray version of the output data.</span>

<span class="sd">    Note:</span>
<span class="sd">        This function is used when the output data needs to be in the form of a structured array and is currently in the form of a regular numpy ndarray.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = np.array([[1, &#39;a&#39;, 0.5], [2, &#39;b&#39;, 0.6]])</span>
<span class="sd">        &gt;&gt;&gt; preparer = ByPassPreparer()</span>
<span class="sd">        &gt;&gt;&gt; preparer.prepare_output_structured_data(data)</span>
<span class="sd">        rec.array([(1, &#39;a&#39;, 0.5), (2, &#39;b&#39;, 0.6)],</span>
<span class="sd">        dtype=[(&#39;f0&#39;, &#39;&lt;i4&#39;), (&#39;f1&#39;, &#39;S1&#39;), (&#39;f2&#39;, &#39;&lt;f8&#39;)])</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="reshaper"><red>Reshaper</red><a class="headerlink" href="#reshaper" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.Reshaper"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="simulai.abstract.DataPreparer">DataPreparer</span></code></p>

  
      <p>Reshaper converts n-dimensional arrays to two-dimensional ones, performing a simple reshaping operation F: (n0, n1, ..., nm) -&gt; (n0, prod(n1, ..., nm))</p>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">136</span>
<span class="normal">137</span>
<span class="normal">138</span>
<span class="normal">139</span>
<span class="normal">140</span>
<span class="normal">141</span>
<span class="normal">142</span>
<span class="normal">143</span>
<span class="normal">144</span>
<span class="normal">145</span>
<span class="normal">146</span>
<span class="normal">147</span>
<span class="normal">148</span>
<span class="normal">149</span>
<span class="normal">150</span>
<span class="normal">151</span>
<span class="normal">152</span>
<span class="normal">153</span>
<span class="normal">154</span>
<span class="normal">155</span>
<span class="normal">156</span>
<span class="normal">157</span>
<span class="normal">158</span>
<span class="normal">159</span>
<span class="normal">160</span>
<span class="normal">161</span>
<span class="normal">162</span>
<span class="normal">163</span>
<span class="normal">164</span>
<span class="normal">165</span>
<span class="normal">166</span>
<span class="normal">167</span>
<span class="normal">168</span>
<span class="normal">169</span>
<span class="normal">170</span>
<span class="normal">171</span>
<span class="normal">172</span>
<span class="normal">173</span>
<span class="normal">174</span>
<span class="normal">175</span>
<span class="normal">176</span>
<span class="normal">177</span>
<span class="normal">178</span>
<span class="normal">179</span>
<span class="normal">180</span>
<span class="normal">181</span>
<span class="normal">182</span>
<span class="normal">183</span>
<span class="normal">184</span>
<span class="normal">185</span>
<span class="normal">186</span>
<span class="normal">187</span>
<span class="normal">188</span>
<span class="normal">189</span>
<span class="normal">190</span>
<span class="normal">191</span>
<span class="normal">192</span>
<span class="normal">193</span>
<span class="normal">194</span>
<span class="normal">195</span>
<span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span>
<span class="normal">226</span>
<span class="normal">227</span>
<span class="normal">228</span>
<span class="normal">229</span>
<span class="normal">230</span>
<span class="normal">231</span>
<span class="normal">232</span>
<span class="normal">233</span>
<span class="normal">234</span>
<span class="normal">235</span>
<span class="normal">236</span>
<span class="normal">237</span>
<span class="normal">238</span>
<span class="normal">239</span>
<span class="normal">240</span>
<span class="normal">241</span>
<span class="normal">242</span>
<span class="normal">243</span>
<span class="normal">244</span>
<span class="normal">245</span>
<span class="normal">246</span>
<span class="normal">247</span>
<span class="normal">248</span>
<span class="normal">249</span>
<span class="normal">250</span>
<span class="normal">251</span>
<span class="normal">252</span>
<span class="normal">253</span>
<span class="normal">254</span>
<span class="normal">255</span>
<span class="normal">256</span>
<span class="normal">257</span>
<span class="normal">258</span>
<span class="normal">259</span>
<span class="normal">260</span>
<span class="normal">261</span>
<span class="normal">262</span>
<span class="normal">263</span>
<span class="normal">264</span>
<span class="normal">265</span>
<span class="normal">266</span>
<span class="normal">267</span>
<span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span>
<span class="normal">280</span>
<span class="normal">281</span>
<span class="normal">282</span>
<span class="normal">283</span>
<span class="normal">284</span>
<span class="normal">285</span>
<span class="normal">286</span>
<span class="normal">287</span>
<span class="normal">288</span>
<span class="normal">289</span>
<span class="normal">290</span>
<span class="normal">291</span>
<span class="normal">292</span>
<span class="normal">293</span>
<span class="normal">294</span>
<span class="normal">295</span>
<span class="normal">296</span>
<span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span>
<span class="normal">308</span>
<span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span>
<span class="normal">320</span>
<span class="normal">321</span>
<span class="normal">322</span>
<span class="normal">323</span>
<span class="normal">324</span>
<span class="normal">325</span>
<span class="normal">326</span>
<span class="normal">327</span>
<span class="normal">328</span>
<span class="normal">329</span>
<span class="normal">330</span>
<span class="normal">331</span>
<span class="normal">332</span>
<span class="normal">333</span>
<span class="normal">334</span>
<span class="normal">335</span>
<span class="normal">336</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Reshaper</span><span class="p">(</span><span class="n">DataPreparer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reshaper converts n-dimensional arrays to two-dimensional ones, performing a simple reshaping operation F: (n0, n1, ..., nm) -&gt; (n0, prod(n1, ..., nm))&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;reshaper&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels_last</span> <span class="o">=</span> <span class="n">channels_last</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collapsible_shapes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collapsed_shape</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">_set_shapes_from_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional): The input data to reshape. (Default value = None)</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; reshaper = Reshaper()</span>
<span class="sd">            &gt;&gt;&gt; reshaper._set_shapes_from_data(np.random.random((10,3,4,5)))</span>
<span class="sd">            &gt;&gt;&gt; reshaper.collapsible_shapes</span>
<span class="sd">            (3, 4, 5)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">collapsible_shapes</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">collapsed_shape</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">prod</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">collapsible_shapes</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_is_recarray</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recarray</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">collapsed_shape</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">collapsed_shape</span>

    <span class="k">def</span> <span class="nf">_prepare_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            This function reshapes the input data to (n0, prod(n1, ..., nm)) shape.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; reshaper = Reshaper()</span>
<span class="sd">            &gt;&gt;&gt; data = np.random.random((10,3,4,5))</span>
<span class="sd">            &gt;&gt;&gt; reshaper.prepare_input_data(data)</span>
<span class="sd">            array([[0.527, 0.936, ... , 0.812],</span>
<span class="sd">                  [0.947, 0.865, ... , 0.947],</span>
<span class="sd">                  ...,</span>
<span class="sd">                  [0.865, 0.947, ... , 0.865],</span>
<span class="sd">                  [0.947, 0.865, ... , 0.947]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Error! data must have at least two dimensions&quot;</span>
        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">))</span>

    <span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare input data for reshaping.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Union[np.ndarray, np.recarray]):</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            - If `data` is a structured numpy array, it will be passed to `_prepare_input_structured_data` function.</span>
<span class="sd">            - If `data` is a plain numpy array, it will be passed to `_prepare_input_data` function.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; reshaper = Reshaper()</span>
<span class="sd">            &gt;&gt;&gt; input_data = np.random.rand(2, 3, 4)</span>
<span class="sd">            &gt;&gt;&gt; reshaper.prepare_input_data(input_data)</span>
<span class="sd">            array([[ 0.948...,  0.276...,  0.967...,  0.564...],</span>
<span class="sd">                [ 0.276...,  0.948...,  0.564...,  0.967...],</span>
<span class="sd">                [ 0.276...,  0.948...,  0.564...,  0.967...],</span>
<span class="sd">                [ 0.948...,  0.276...,  0.967...,  0.564...],</span>
<span class="sd">                [ 0.276...,  0.948...,  0.564...,  0.967...],</span>
<span class="sd">                [ 0.276...,  0.948...,  0.564...,  0.967...]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_set_shapes_from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recarray</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_reshape_to_output</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reshape the data to its original shape before reshaping.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray):</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            The original shape of the data is stored in `collapsible_shapes` attribute.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; reshaper = Reshaper()</span>
<span class="sd">            &gt;&gt;&gt; input_data = np.random.rand(2, 3, 4)</span>
<span class="sd">            &gt;&gt;&gt; reshaper._set_shapes_from_data(input_data)</span>
<span class="sd">            &gt;&gt;&gt; reshaped_data = reshaper._reshape_to_output(input_data.flatten())</span>
<span class="sd">            &gt;&gt;&gt; reshaped_data.shape</span>
<span class="sd">            (2, 3, 4)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">((</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">collapsible_shapes</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_output_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">single</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the input data to be in the shape and format expected by the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional): The input data to be prepared, by default None</span>
<span class="sd">            single (bool, optional):  (Default value = False)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The prepared input data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recarray</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reshape_to_output</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepare_output_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">single</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the input data to be in the shape and format expected by the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray): The input data to be prepared</span>
<span class="sd">            single (bool, optional):  (Default value = False)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The prepared input data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_output_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_input_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the input structured data to be in the shape and format expected by the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.recarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The prepared input structured data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_set_shapes_from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data_</span> <span class="o">=</span> <span class="n">recfunctions</span><span class="o">.</span><span class="n">structured_to_unstructured</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">reshaped_data_</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_input_data</span><span class="p">(</span><span class="n">data_</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">reshaped_data_</span>

    <span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the input structured data to be in the shape and format expected by the model.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.recarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The prepared input structured data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepare_output_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the output data to be in the shape and format expected by the user.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.recarray: The prepared output structured data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_prepare_output_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the output data to be in the shape and format expected by the user.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.recarray: The prepared output structured data</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span>
            <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">collapsible_shapes</span> <span class="o">+</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">),)</span>
        <span class="p">)</span>
        <span class="n">output_data</span> <span class="o">=</span> <span class="n">recfunctions</span><span class="o">.</span><span class="n">unstructured_to_structured</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">output_data</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_reshape_to_output</span><span class="p">(</span><span class="n">output_data</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">output_data</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.Reshaper.prepare_input_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span></code>

<a href="#simulai.io.Reshaper.prepare_input_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare input data for reshaping.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.recarray">recarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>If <code>data</code> is a structured numpy array, it will be passed to <code>_prepare_input_structured_data</code> function.</li>
<li>If <code>data</code> is a plain numpy array, it will be passed to <code>_prepare_input_data</code> function.</li>
</ul>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; reshaper = Reshaper()
&gt;&gt;&gt; input_data = np.random.rand(2, 3, 4)
&gt;&gt;&gt; reshaper.prepare_input_data(input_data)
array([[ 0.948...,  0.276...,  0.967...,  0.564...],
    [ 0.276...,  0.948...,  0.564...,  0.967...],
    [ 0.276...,  0.948...,  0.564...,  0.967...],
    [ 0.948...,  0.276...,  0.967...,  0.564...],
    [ 0.276...,  0.948...,  0.564...,  0.967...],
    [ 0.276...,  0.948...,  0.564...,  0.967...]])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">196</span>
<span class="normal">197</span>
<span class="normal">198</span>
<span class="normal">199</span>
<span class="normal">200</span>
<span class="normal">201</span>
<span class="normal">202</span>
<span class="normal">203</span>
<span class="normal">204</span>
<span class="normal">205</span>
<span class="normal">206</span>
<span class="normal">207</span>
<span class="normal">208</span>
<span class="normal">209</span>
<span class="normal">210</span>
<span class="normal">211</span>
<span class="normal">212</span>
<span class="normal">213</span>
<span class="normal">214</span>
<span class="normal">215</span>
<span class="normal">216</span>
<span class="normal">217</span>
<span class="normal">218</span>
<span class="normal">219</span>
<span class="normal">220</span>
<span class="normal">221</span>
<span class="normal">222</span>
<span class="normal">223</span>
<span class="normal">224</span>
<span class="normal">225</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare input data for reshaping.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Union[np.ndarray, np.recarray]):</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        - If `data` is a structured numpy array, it will be passed to `_prepare_input_structured_data` function.</span>
<span class="sd">        - If `data` is a plain numpy array, it will be passed to `_prepare_input_data` function.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; reshaper = Reshaper()</span>
<span class="sd">        &gt;&gt;&gt; input_data = np.random.rand(2, 3, 4)</span>
<span class="sd">        &gt;&gt;&gt; reshaper.prepare_input_data(input_data)</span>
<span class="sd">        array([[ 0.948...,  0.276...,  0.967...,  0.564...],</span>
<span class="sd">            [ 0.276...,  0.948...,  0.564...,  0.967...],</span>
<span class="sd">            [ 0.276...,  0.948...,  0.564...,  0.967...],</span>
<span class="sd">            [ 0.948...,  0.276...,  0.967...,  0.564...],</span>
<span class="sd">            [ 0.276...,  0.948...,  0.564...,  0.967...],</span>
<span class="sd">            [ 0.276...,  0.948...,  0.564...,  0.967...]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">_set_shapes_from_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.Reshaper.prepare_input_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.Reshaper.prepare_input_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare the input structured data to be in the shape and format expected by the model.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.recarray">recarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray: The prepared input structured data</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">297</span>
<span class="normal">298</span>
<span class="normal">299</span>
<span class="normal">300</span>
<span class="normal">301</span>
<span class="normal">302</span>
<span class="normal">303</span>
<span class="normal">304</span>
<span class="normal">305</span>
<span class="normal">306</span>
<span class="normal">307</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the input structured data to be in the shape and format expected by the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.recarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The prepared input structured data</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.Reshaper.prepare_output_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_output_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">single</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#simulai.io.Reshaper.prepare_output_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare the input data to be in the shape and format expected by the model.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input data to be prepared</p>
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
        <tr>
          <td><code>single</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = False)</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray: The prepared input data</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">268</span>
<span class="normal">269</span>
<span class="normal">270</span>
<span class="normal">271</span>
<span class="normal">272</span>
<span class="normal">273</span>
<span class="normal">274</span>
<span class="normal">275</span>
<span class="normal">276</span>
<span class="normal">277</span>
<span class="normal">278</span>
<span class="normal">279</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_output_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">single</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the input data to be in the shape and format expected by the model.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray): The input data to be prepared</span>
<span class="sd">        single (bool, optional):  (Default value = False)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The prepared input data</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_output_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.Reshaper.prepare_output_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.Reshaper.prepare_output_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare the output data to be in the shape and format expected by the user.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.recarray">recarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.recarray: The prepared output structured data</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">309</span>
<span class="normal">310</span>
<span class="normal">311</span>
<span class="normal">312</span>
<span class="normal">313</span>
<span class="normal">314</span>
<span class="normal">315</span>
<span class="normal">316</span>
<span class="normal">317</span>
<span class="normal">318</span>
<span class="normal">319</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_output_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the output data to be in the shape and format expected by the user.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.recarray: The prepared output structured data</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="scalerreshaper"><red>ScalerReshaper</red><a class="headerlink" href="#scalerreshaper" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.ScalerReshaper"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="simulai.io.Reshaper" href="#simulai.io.Reshaper">Reshaper</a></code></p>

  
      <p>ScalerReshaper is a class that inherits from the Reshaper class and performs additional scaling on the input data.</p>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">339</span>
<span class="normal">340</span>
<span class="normal">341</span>
<span class="normal">342</span>
<span class="normal">343</span>
<span class="normal">344</span>
<span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span>
<span class="normal">359</span>
<span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span>
<span class="normal">388</span>
<span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span>
<span class="normal">417</span>
<span class="normal">418</span>
<span class="normal">419</span>
<span class="normal">420</span>
<span class="normal">421</span>
<span class="normal">422</span>
<span class="normal">423</span>
<span class="normal">424</span>
<span class="normal">425</span>
<span class="normal">426</span>
<span class="normal">427</span>
<span class="normal">428</span>
<span class="normal">429</span>
<span class="normal">430</span>
<span class="normal">431</span>
<span class="normal">432</span>
<span class="normal">433</span>
<span class="normal">434</span>
<span class="normal">435</span>
<span class="normal">436</span>
<span class="normal">437</span>
<span class="normal">438</span>
<span class="normal">439</span>
<span class="normal">440</span>
<span class="normal">441</span>
<span class="normal">442</span>
<span class="normal">443</span>
<span class="normal">444</span>
<span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span>
<span class="normal">477</span>
<span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">ScalerReshaper</span><span class="p">(</span><span class="n">Reshaper</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;ScalerReshaper is a class that inherits from the Reshaper class and performs additional scaling on the input data.&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;scalerreshaper&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">bias</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">channels_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Reshaper converts n-dimensional arrays to two-dimensional ones, performing a</span>
<span class="sd">        simple reshaping operation F: (n0, n1, ..., nm) -&gt; (n0, prod(n1, ..., nm))</span>

<span class="sd">        Args:</span>
<span class="sd">            bias (float, optional):  (Default value = 0.0)</span>
<span class="sd">            scale (float, optional):  (Default value = 1.0)</span>
<span class="sd">            channels_last (bool, optional):  (Default value = False)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">channels_last</span><span class="o">=</span><span class="n">channels_last</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>

    <span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the input data by subtracting the bias and scaling the data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Union[np.ndarray, np.recarray], optional): The input data to be prepared (Default value = None)</span>
<span class="sd">            *args:</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The prepared input data</span>

<span class="sd">        Note:</span>
<span class="sd">            If the input data is a structured array, the method &#39;prepare_input_structured_data&#39; will be called instead.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; reshaper = ScalerReshaper(bias=10, scale=2)</span>
<span class="sd">            &gt;&gt;&gt; reshaper.prepare_input_data(np.array([1, 2, 3]))</span>
<span class="sd">            array([-4.5, -3.5, -2.5])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalerReshaper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_input_data</span><span class="p">(</span>
                <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepare_output_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare the output data by scaling it and adding the bias.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (Union[np.ndarray, np.recarray], optional): The output data to be prepared (Default value = None)</span>
<span class="sd">            *args:</span>
<span class="sd">            **kwargs</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The prepared output data</span>

<span class="sd">        Note:</span>
<span class="sd">            If the input data is a structured array, the method &#39;prepare_output_structured_data&#39; will be called</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; reshaper = ScalerReshaper(bias=10, scale=2)</span>
<span class="sd">            &gt;&gt;&gt; reshaper.prepare_output_data(np.array([1, 2, 3]))</span>
<span class="sd">            array([12., 14., 16.])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recarray</span><span class="p">:</span>
            <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalerReshaper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_output_data</span><span class="p">(</span>
                <span class="n">data</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_get_structured_bias_scale</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dtype</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the bias and scale values for each field of a structured array.</span>

<span class="sd">        Args:</span>
<span class="sd">            dtype (np.dtype, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[dict, dict]: A tuple of two dictionaries, the first containing the bias values for each field and the second</span>

<span class="sd">        Note:</span>
<span class="sd">            If the bias and scale attributes are floats, they will be used for all fields.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; reshaper = ScalerReshaper(bias=10, scale=2)</span>
<span class="sd">            &gt;&gt;&gt; reshaper._get_structured_bias_scale(np.dtype([(&#39;a&#39;, float), (&#39;b&#39;, float)]))</span>
<span class="sd">            ({&#39;a&#39;: 10, &#39;b&#39;: 10}, {&#39;a&#39;: 2, &#39;b&#39;: 2})</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bias</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">bias</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">}</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="n">scale</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">}</span>

        <span class="k">return</span> <span class="n">bias</span><span class="p">,</span> <span class="n">scale</span>

    <span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scale and reshape structured data (np.recarray) before passing it to the next layer.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.recarray, optional): structured data to be transformed (Default value = None)</span>
<span class="sd">            *args (Additional arguments passed to the parent class):</span>
<span class="sd">            **kwargs</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            The bias and scale parameters are expected to be provided in the form of dictionaries, where keys are field names and values are the corresponding bias and scale values for those fields.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = np.array([(1, 2, 3), (4, 5, 6)], dtype=[(&quot;a&quot;, int), (&quot;b&quot;, int), (&quot;c&quot;, int)])</span>
<span class="sd">            &gt;&gt;&gt; reshaper = ScalerReshaper(bias={&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}, scale={&#39;a&#39;: 2, &#39;b&#39;: 3, &#39;c&#39;: 4})</span>
<span class="sd">            &gt;&gt;&gt; reshaper.prepare_input_structured_data(data)</span>
<span class="sd">                array([[-0.5, 0.33333333, 0.75      ],</span>
<span class="sd">                    [ 1.5, 1.66666667, 2.        ]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bias</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_structured_bias_scale</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">-</span> <span class="n">bias</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">/</span> <span class="n">scale</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalerReshaper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_input_structured_data</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepare_output_structured_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Scale and reshape structured data (np.recarray) before passing it to the next layer.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional): structured data to be transformed (Default value = None)</span>
<span class="sd">            *args (Additional arguments passed to the parent class):</span>
<span class="sd">            **kwargs:</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.recarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            - The bias and scale parameters are expected to be provided in the form of dictionaries, where keys are field names and values are the corresponding bias and scale values for those fields.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = np.array([[-0.5, 0.33333333, 0.75      ],</span>
<span class="sd">            &gt;&gt;&gt;                  [ 1.5, 1.66666667, 2.        ]])</span>
<span class="sd">            &gt;&gt;&gt; reshaper = ScalerReshaper(bias={&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}, scale={&#39;a&#39;: 2, &#39;b&#39;: 3, &#39;c&#39;: 4})</span>
<span class="sd">            &gt;&gt;&gt; reshaper.prepare_output_structured_data(data)</span>
<span class="sd">            rec.array([(0., 2.,  6.), (6., 8., 12.)],</span>
<span class="sd">                dtype=[(&#39;a&#39;, &#39;&lt;f8&#39;), (&#39;b&#39;, &#39;&lt;f8&#39;), (&#39;c&#39;, &#39;&lt;f8&#39;)])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">bias</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_structured_bias_scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalerReshaper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_output_structured_data</span><span class="p">(</span>
            <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
            <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="n">bias</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.ScalerReshaper.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">bias</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">channels_last</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#simulai.io.ScalerReshaper.__init__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Reshaper converts n-dimensional arrays to two-dimensional ones, performing a
simple reshaping operation F: (n0, n1, ..., nm) -&gt; (n0, prod(n1, ..., nm))</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>bias</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = 0.0)</p>
            </div>
          </td>
          <td>
                <code>0.0</code>
          </td>
        </tr>
        <tr>
          <td><code>scale</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = 1.0)</p>
            </div>
          </td>
          <td>
                <code>1.0</code>
          </td>
        </tr>
        <tr>
          <td><code>channels_last</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = False)</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">345</span>
<span class="normal">346</span>
<span class="normal">347</span>
<span class="normal">348</span>
<span class="normal">349</span>
<span class="normal">350</span>
<span class="normal">351</span>
<span class="normal">352</span>
<span class="normal">353</span>
<span class="normal">354</span>
<span class="normal">355</span>
<span class="normal">356</span>
<span class="normal">357</span>
<span class="normal">358</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">bias</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">,</span> <span class="n">scale</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">channels_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Reshaper converts n-dimensional arrays to two-dimensional ones, performing a</span>
<span class="sd">    simple reshaping operation F: (n0, n1, ..., nm) -&gt; (n0, prod(n1, ..., nm))</span>

<span class="sd">    Args:</span>
<span class="sd">        bias (float, optional):  (Default value = 0.0)</span>
<span class="sd">        scale (float, optional):  (Default value = 1.0)</span>
<span class="sd">        channels_last (bool, optional):  (Default value = False)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">channels_last</span><span class="o">=</span><span class="n">channels_last</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">bias</span> <span class="o">=</span> <span class="n">bias</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">=</span> <span class="n">scale</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.ScalerReshaper.prepare_input_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#simulai.io.ScalerReshaper.prepare_input_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare the input data by subtracting the bias and scaling the data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.recarray">recarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input data to be prepared (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray: The prepared input data</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>If the input data is a structured array, the method 'prepare_input_structured_data' will be called instead.</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; reshaper = ScalerReshaper(bias=10, scale=2)
&gt;&gt;&gt; reshaper.prepare_input_data(np.array([1, 2, 3]))
array([-4.5, -3.5, -2.5])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">360</span>
<span class="normal">361</span>
<span class="normal">362</span>
<span class="normal">363</span>
<span class="normal">364</span>
<span class="normal">365</span>
<span class="normal">366</span>
<span class="normal">367</span>
<span class="normal">368</span>
<span class="normal">369</span>
<span class="normal">370</span>
<span class="normal">371</span>
<span class="normal">372</span>
<span class="normal">373</span>
<span class="normal">374</span>
<span class="normal">375</span>
<span class="normal">376</span>
<span class="normal">377</span>
<span class="normal">378</span>
<span class="normal">379</span>
<span class="normal">380</span>
<span class="normal">381</span>
<span class="normal">382</span>
<span class="normal">383</span>
<span class="normal">384</span>
<span class="normal">385</span>
<span class="normal">386</span>
<span class="normal">387</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the input data by subtracting the bias and scaling the data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Union[np.ndarray, np.recarray], optional): The input data to be prepared (Default value = None)</span>
<span class="sd">        *args:</span>
<span class="sd">        **kwargs:</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The prepared input data</span>

<span class="sd">    Note:</span>
<span class="sd">        If the input data is a structured array, the method &#39;prepare_input_structured_data&#39; will be called instead.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; reshaper = ScalerReshaper(bias=10, scale=2)</span>
<span class="sd">        &gt;&gt;&gt; reshaper.prepare_input_data(np.array([1, 2, 3]))</span>
<span class="sd">        array([-4.5, -3.5, -2.5])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalerReshaper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_input_data</span><span class="p">(</span>
            <span class="p">(</span><span class="n">data</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">)</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.ScalerReshaper.prepare_input_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#simulai.io.ScalerReshaper.prepare_input_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Scale and reshape structured data (np.recarray) before passing it to the next layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.recarray">recarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>structured data to be transformed (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
                <code>Additional arguments passed to the parent class</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>The bias and scale parameters are expected to be provided in the form of dictionaries, where keys are field names and values are the corresponding bias and scale values for those fields.</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; data = np.array([(1, 2, 3), (4, 5, 6)], dtype=[("a", int), ("b", int), ("c", int)])
&gt;&gt;&gt; reshaper = ScalerReshaper(bias={'a': 1, 'b': 2, 'c': 3}, scale={'a': 2, 'b': 3, 'c': 4})
&gt;&gt;&gt; reshaper.prepare_input_structured_data(data)
    array([[-0.5, 0.33333333, 0.75      ],
        [ 1.5, 1.66666667, 2.        ]])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">445</span>
<span class="normal">446</span>
<span class="normal">447</span>
<span class="normal">448</span>
<span class="normal">449</span>
<span class="normal">450</span>
<span class="normal">451</span>
<span class="normal">452</span>
<span class="normal">453</span>
<span class="normal">454</span>
<span class="normal">455</span>
<span class="normal">456</span>
<span class="normal">457</span>
<span class="normal">458</span>
<span class="normal">459</span>
<span class="normal">460</span>
<span class="normal">461</span>
<span class="normal">462</span>
<span class="normal">463</span>
<span class="normal">464</span>
<span class="normal">465</span>
<span class="normal">466</span>
<span class="normal">467</span>
<span class="normal">468</span>
<span class="normal">469</span>
<span class="normal">470</span>
<span class="normal">471</span>
<span class="normal">472</span>
<span class="normal">473</span>
<span class="normal">474</span>
<span class="normal">475</span>
<span class="normal">476</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale and reshape structured data (np.recarray) before passing it to the next layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.recarray, optional): structured data to be transformed (Default value = None)</span>
<span class="sd">        *args (Additional arguments passed to the parent class):</span>
<span class="sd">        **kwargs</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        The bias and scale parameters are expected to be provided in the form of dictionaries, where keys are field names and values are the corresponding bias and scale values for those fields.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = np.array([(1, 2, 3), (4, 5, 6)], dtype=[(&quot;a&quot;, int), (&quot;b&quot;, int), (&quot;c&quot;, int)])</span>
<span class="sd">        &gt;&gt;&gt; reshaper = ScalerReshaper(bias={&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}, scale={&#39;a&#39;: 2, &#39;b&#39;: 3, &#39;c&#39;: 4})</span>
<span class="sd">        &gt;&gt;&gt; reshaper.prepare_input_structured_data(data)</span>
<span class="sd">            array([[-0.5, 0.33333333, 0.75      ],</span>
<span class="sd">                [ 1.5, 1.66666667, 2.        ]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bias</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_structured_bias_scale</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="n">names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">-</span> <span class="n">bias</span><span class="p">[</span><span class="n">name</span><span class="p">])</span> <span class="o">/</span> <span class="n">scale</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalerReshaper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_input_structured_data</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.ScalerReshaper.prepare_output_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_output_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#simulai.io.ScalerReshaper.prepare_output_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare the output data by scaling it and adding the bias.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.recarray">recarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The output data to be prepared (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray: The prepared output data</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>If the input data is a structured array, the method 'prepare_output_structured_data' will be called</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; reshaper = ScalerReshaper(bias=10, scale=2)
&gt;&gt;&gt; reshaper.prepare_output_data(np.array([1, 2, 3]))
array([12., 14., 16.])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">389</span>
<span class="normal">390</span>
<span class="normal">391</span>
<span class="normal">392</span>
<span class="normal">393</span>
<span class="normal">394</span>
<span class="normal">395</span>
<span class="normal">396</span>
<span class="normal">397</span>
<span class="normal">398</span>
<span class="normal">399</span>
<span class="normal">400</span>
<span class="normal">401</span>
<span class="normal">402</span>
<span class="normal">403</span>
<span class="normal">404</span>
<span class="normal">405</span>
<span class="normal">406</span>
<span class="normal">407</span>
<span class="normal">408</span>
<span class="normal">409</span>
<span class="normal">410</span>
<span class="normal">411</span>
<span class="normal">412</span>
<span class="normal">413</span>
<span class="normal">414</span>
<span class="normal">415</span>
<span class="normal">416</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_output_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare the output data by scaling it and adding the bias.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (Union[np.ndarray, np.recarray], optional): The output data to be prepared (Default value = None)</span>
<span class="sd">        *args:</span>
<span class="sd">        **kwargs</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: The prepared output data</span>

<span class="sd">    Note:</span>
<span class="sd">        If the input data is a structured array, the method &#39;prepare_output_structured_data&#39; will be called</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; reshaper = ScalerReshaper(bias=10, scale=2)</span>
<span class="sd">        &gt;&gt;&gt; reshaper.prepare_output_data(np.array([1, 2, 3]))</span>
<span class="sd">        array([12., 14., 16.])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">_is_recarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalerReshaper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_output_data</span><span class="p">(</span>
            <span class="n">data</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">scale</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">bias</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
        <span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.ScalerReshaper.prepare_output_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#simulai.io.ScalerReshaper.prepare_output_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Scale and reshape structured data (np.recarray) before passing it to the next layer.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>structured data to be transformed (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>*args</code></td>
          <td>
                <code>Additional arguments passed to the parent class</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
                <code>()</code>
          </td>
        </tr>
        <tr>
          <td><code>**kwargs</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
                <code>{}</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.recarray">recarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.recarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The bias and scale parameters are expected to be provided in the form of dictionaries, where keys are field names and values are the corresponding bias and scale values for those fields.</li>
</ul>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; data = np.array([[-0.5, 0.33333333, 0.75      ],
&gt;&gt;&gt;                  [ 1.5, 1.66666667, 2.        ]])
&gt;&gt;&gt; reshaper = ScalerReshaper(bias={'a': 1, 'b': 2, 'c': 3}, scale={'a': 2, 'b': 3, 'c': 4})
&gt;&gt;&gt; reshaper.prepare_output_structured_data(data)
rec.array([(0., 2.,  6.), (6., 8., 12.)],
    dtype=[('a', '&lt;f8'), ('b', '&lt;f8'), ('c', '&lt;f8')])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">478</span>
<span class="normal">479</span>
<span class="normal">480</span>
<span class="normal">481</span>
<span class="normal">482</span>
<span class="normal">483</span>
<span class="normal">484</span>
<span class="normal">485</span>
<span class="normal">486</span>
<span class="normal">487</span>
<span class="normal">488</span>
<span class="normal">489</span>
<span class="normal">490</span>
<span class="normal">491</span>
<span class="normal">492</span>
<span class="normal">493</span>
<span class="normal">494</span>
<span class="normal">495</span>
<span class="normal">496</span>
<span class="normal">497</span>
<span class="normal">498</span>
<span class="normal">499</span>
<span class="normal">500</span>
<span class="normal">501</span>
<span class="normal">502</span>
<span class="normal">503</span>
<span class="normal">504</span>
<span class="normal">505</span>
<span class="normal">506</span>
<span class="normal">507</span>
<span class="normal">508</span>
<span class="normal">509</span>
<span class="normal">510</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_output_structured_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Scale and reshape structured data (np.recarray) before passing it to the next layer.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray, optional): structured data to be transformed (Default value = None)</span>
<span class="sd">        *args (Additional arguments passed to the parent class):</span>
<span class="sd">        **kwargs:</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.recarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        - The bias and scale parameters are expected to be provided in the form of dictionaries, where keys are field names and values are the corresponding bias and scale values for those fields.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = np.array([[-0.5, 0.33333333, 0.75      ],</span>
<span class="sd">        &gt;&gt;&gt;                  [ 1.5, 1.66666667, 2.        ]])</span>
<span class="sd">        &gt;&gt;&gt; reshaper = ScalerReshaper(bias={&#39;a&#39;: 1, &#39;b&#39;: 2, &#39;c&#39;: 3}, scale={&#39;a&#39;: 2, &#39;b&#39;: 3, &#39;c&#39;: 4})</span>
<span class="sd">        &gt;&gt;&gt; reshaper.prepare_output_structured_data(data)</span>
<span class="sd">        rec.array([(0., 2.,  6.), (6., 8., 12.)],</span>
<span class="sd">            dtype=[(&#39;a&#39;, &#39;&lt;f8&#39;), (&#39;b&#39;, &#39;&lt;f8&#39;), (&#39;c&#39;, &#39;&lt;f8&#39;)])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">bias</span><span class="p">,</span> <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_get_structured_bias_scale</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">ScalerReshaper</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_output_structured_data</span><span class="p">(</span>
        <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span>
    <span class="p">)</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
        <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">*</span> <span class="n">scale</span><span class="p">[</span><span class="n">name</span><span class="p">]</span> <span class="o">+</span> <span class="n">bias</span><span class="p">[</span><span class="n">name</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="mapvalid"><red>MapValid</red><a class="headerlink" href="#mapvalid" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.MapValid"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><a class="autorefs autorefs-internal" title="simulai.io.Reshaper" href="#simulai.io.Reshaper">Reshaper</a></code></p>

  
      <p>MapValid is a reshaper class that converts n-dimensional arrays to two-dimensional ones performing a valid values
mapping operation F: F: data.shape = (n0, n1, ..., nm) -&gt; data'.shape = (n0, n_valids)
where n_valids is the number of valid elements in the data array.
This class is useful for datasets in which there are invalid data.</p>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">513</span>
<span class="normal">514</span>
<span class="normal">515</span>
<span class="normal">516</span>
<span class="normal">517</span>
<span class="normal">518</span>
<span class="normal">519</span>
<span class="normal">520</span>
<span class="normal">521</span>
<span class="normal">522</span>
<span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span>
<span class="normal">565</span>
<span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span>
<span class="normal">609</span>
<span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span>
<span class="normal">656</span>
<span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span>
<span class="normal">680</span>
<span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MapValid</span><span class="p">(</span><span class="n">Reshaper</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;MapValid is a reshaper class that converts n-dimensional arrays to two-dimensional ones performing a valid values</span>
<span class="sd">    mapping operation F: F: data.shape = (n0, n1, ..., nm) -&gt; data&#39;.shape = (n0, n_valids)</span>
<span class="sd">    where n_valids is the number of valid elements in the data array.</span>
<span class="sd">    This class is useful for datasets in which there are invalid data.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;map_valid&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channels_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the MapValid class with the configurations and mask passed as parameters.</span>

<span class="sd">        Args:</span>
<span class="sd">            config (dict, optional): configurations dictionary, by default None</span>
<span class="sd">            mask (int, np.NaN, np.inf, optional, optional): mask to select the invalid values, by default None</span>
<span class="sd">            channels_last (bool, optional): if set to True, move the channel dimension to the last, by default True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">default_dtype</span> <span class="o">=</span> <span class="s2">&quot;float64&quot;</span>

        <span class="k">if</span> <span class="n">mask</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">replace_mask_with_large_number</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">replace_mask_with_large_number</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">return_the_same_mask</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="c1"># Default value for very large numbers</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">large_number</span> <span class="o">=</span> <span class="mf">1e15</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">mask</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_mask_with_large_number</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">large_number</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">mask_</span> <span class="o">=</span> <span class="n">mask</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_dimensions</span> <span class="o">=</span> <span class="kc">None</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">channels_last</span> <span class="o">=</span> <span class="n">channels_last</span>

    <span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Internal input data preparer, executed for each label of the structured array</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            - MapValid converts n-dimensional arrays to two-dimensional ones performing a valid values</span>
<span class="sd">            mapping operation F: F: data.shape = (n0, n1, ..., nm) -&gt; data&#39;.shape = (n0, n_valids)</span>
<span class="sd">            n_valids = dim([k in data[0, ...] if k != mask])</span>
<span class="sd">            - WARNING: the invalid positions are expected to be static in relation to n0.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]])</span>
<span class="sd">            &gt;&gt;&gt; prepare_input_data(data)</span>
<span class="sd">            array([[1, 2, 3],</span>
<span class="sd">                   [5, 6, 7],</span>
<span class="sd">                   [9, 10, 11]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MapValid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">large_number</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>

        <span class="k">elif</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="s2">&quot;The chosen mask </span><span class="si">{}</span><span class="s2"> does not fit in any supported case&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
                <span class="p">)</span>
            <span class="p">)</span>

        <span class="n">samples_dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">valid_indices</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">samples_dim</span><span class="p">),)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices_</span>

        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">prepare_output_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare output data for the MapValid operation.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            - The reshaped data will have shape (n0, n_valids) where n0 is the number of samples and n_valids are the number of valid values in the data.</span>
<span class="sd">            - If the return_the_same_mask attribute is set to True, the mask used to select the invalid values will be returned. Otherwise, the reshaped data will be filled with NaN.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; reshaper = MapValid()</span>
<span class="sd">            &gt;&gt;&gt; data = np.array([[[1, 2, 3], [4, 5, 6]], [[7, 8, 9], [10, 11, 12]]])</span>
<span class="sd">            &gt;&gt;&gt; reshaper.prepare_output_data(data)</span>
<span class="sd">            array([[[ 1.,  2.,  3.],</span>
<span class="sd">                    [ 4.,  5.,  6.]],</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">immutable_shape</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">final_shape</span> <span class="o">=</span> <span class="p">(</span>
            <span class="n">immutable_shape</span><span class="p">,</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_the_same_mask</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>  <span class="c1"># For practical purposes</span>
        <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">final_shape</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_dtype</span><span class="p">:</span>
            <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_dtype</span><span class="p">)</span>

        <span class="n">samples_dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">valid_indices</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">samples_dim</span><span class="p">),)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices_</span>

        <span class="n">reshaped_data</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

        <span class="n">reshaped_data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MapValid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_output_data</span><span class="p">(</span><span class="n">reshaped_data</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">reshaped_data</span>

    <span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function is used to prepare structured input data for further processing.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.recarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            This function is a wrapper function that calls the &#39;prepare_input_data&#39; function internally.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; data = np.array([(1, 2, 3), (4, 5, 6)], dtype=[(&#39;a&#39;, int), (&#39;b&#39;, int), (&#39;c&#39;, int)])</span>
<span class="sd">            &gt;&gt;&gt; model = MapValid()</span>
<span class="sd">            &gt;&gt;&gt; prepared_data = MapValid.prepare_input_structured_data(data)</span>
<span class="sd">            &gt;&gt;&gt; prepared_data</span>
<span class="sd">            array([[1, 2, 3],</span>
<span class="sd">                  [4, 5, 6]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">prepare_output_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;This function is used to prepare structured output data for further processing.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            This function is a wrapper function that calls the &#39;prepare_output_data&#39; function internally.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6]])</span>
<span class="sd">            &gt;&gt;&gt; model = MapValid()</span>
<span class="sd">            &gt;&gt;&gt; prepared_data = MapValid.prepare_output_structured_data(data)</span>
<span class="sd">            &gt;&gt;&gt; prepared_data</span>
<span class="sd">            array([[1, 2, 3],</span>
<span class="sd">                [4, 5, 6]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_output_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.MapValid.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channels_last</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#simulai.io.MapValid.__init__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Initialize the MapValid class with the configurations and mask passed as parameters.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>config</code></td>
          <td>
                <code>dict</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>configurations dictionary, by default None</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>mask</code></td>
          <td>
                <code>(int, <span title="numpy.NaN">NaN</span>, <span title="numpy.inf">inf</span>, optional)</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>mask to select the invalid values, by default None</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>channels_last</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>if set to True, move the channel dimension to the last, by default True</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">523</span>
<span class="normal">524</span>
<span class="normal">525</span>
<span class="normal">526</span>
<span class="normal">527</span>
<span class="normal">528</span>
<span class="normal">529</span>
<span class="normal">530</span>
<span class="normal">531</span>
<span class="normal">532</span>
<span class="normal">533</span>
<span class="normal">534</span>
<span class="normal">535</span>
<span class="normal">536</span>
<span class="normal">537</span>
<span class="normal">538</span>
<span class="normal">539</span>
<span class="normal">540</span>
<span class="normal">541</span>
<span class="normal">542</span>
<span class="normal">543</span>
<span class="normal">544</span>
<span class="normal">545</span>
<span class="normal">546</span>
<span class="normal">547</span>
<span class="normal">548</span>
<span class="normal">549</span>
<span class="normal">550</span>
<span class="normal">551</span>
<span class="normal">552</span>
<span class="normal">553</span>
<span class="normal">554</span>
<span class="normal">555</span>
<span class="normal">556</span>
<span class="normal">557</span>
<span class="normal">558</span>
<span class="normal">559</span>
<span class="normal">560</span>
<span class="normal">561</span>
<span class="normal">562</span>
<span class="normal">563</span>
<span class="normal">564</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">mask</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">channels_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initialize the MapValid class with the configurations and mask passed as parameters.</span>

<span class="sd">    Args:</span>
<span class="sd">        config (dict, optional): configurations dictionary, by default None</span>
<span class="sd">        mask (int, np.NaN, np.inf, optional, optional): mask to select the invalid values, by default None</span>
<span class="sd">        channels_last (bool, optional): if set to True, move the channel dimension to the last, by default True</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">default_dtype</span> <span class="o">=</span> <span class="s2">&quot;float64&quot;</span>

    <span class="k">if</span> <span class="n">mask</span> <span class="o">==</span> <span class="mi">0</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">mask</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replace_mask_with_large_number</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">replace_mask_with_large_number</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">return_the_same_mask</span> <span class="o">=</span> <span class="kc">True</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="c1"># Default value for very large numbers</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">large_number</span> <span class="o">=</span> <span class="mf">1e15</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">mask</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">replace_mask_with_large_number</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">large_number</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">=</span> <span class="n">mask</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">mask_</span> <span class="o">=</span> <span class="n">mask</span>

    <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">config</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">original_dimensions</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">channels_last</span> <span class="o">=</span> <span class="n">channels_last</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.MapValid.prepare_input_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.MapValid.prepare_input_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Internal input data preparer, executed for each label of the structured array</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>MapValid converts n-dimensional arrays to two-dimensional ones performing a valid values
mapping operation F: F: data.shape = (n0, n1, ..., nm) -&gt; data'.shape = (n0, n_valids)
n_valids = dim([k in data[0, ...] if k != mask])</li>
<li>WARNING: the invalid positions are expected to be static in relation to n0.</li>
</ul>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; data = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]])
&gt;&gt;&gt; prepare_input_data(data)
array([[1, 2, 3],
       [5, 6, 7],
       [9, 10, 11]])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">566</span>
<span class="normal">567</span>
<span class="normal">568</span>
<span class="normal">569</span>
<span class="normal">570</span>
<span class="normal">571</span>
<span class="normal">572</span>
<span class="normal">573</span>
<span class="normal">574</span>
<span class="normal">575</span>
<span class="normal">576</span>
<span class="normal">577</span>
<span class="normal">578</span>
<span class="normal">579</span>
<span class="normal">580</span>
<span class="normal">581</span>
<span class="normal">582</span>
<span class="normal">583</span>
<span class="normal">584</span>
<span class="normal">585</span>
<span class="normal">586</span>
<span class="normal">587</span>
<span class="normal">588</span>
<span class="normal">589</span>
<span class="normal">590</span>
<span class="normal">591</span>
<span class="normal">592</span>
<span class="normal">593</span>
<span class="normal">594</span>
<span class="normal">595</span>
<span class="normal">596</span>
<span class="normal">597</span>
<span class="normal">598</span>
<span class="normal">599</span>
<span class="normal">600</span>
<span class="normal">601</span>
<span class="normal">602</span>
<span class="normal">603</span>
<span class="normal">604</span>
<span class="normal">605</span>
<span class="normal">606</span>
<span class="normal">607</span>
<span class="normal">608</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Internal input data preparer, executed for each label of the structured array</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        - MapValid converts n-dimensional arrays to two-dimensional ones performing a valid values</span>
<span class="sd">        mapping operation F: F: data.shape = (n0, n1, ..., nm) -&gt; data&#39;.shape = (n0, n_valids)</span>
<span class="sd">        n_valids = dim([k in data[0, ...] if k != mask])</span>
<span class="sd">        - WARNING: the invalid positions are expected to be static in relation to n0.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = np.array([[1, 2, 3, 4], [5, 6, 7, 8], [9, 10, 11, 12]])</span>
<span class="sd">        &gt;&gt;&gt; prepare_input_data(data)</span>
<span class="sd">        array([[1, 2, 3],</span>
<span class="sd">               [5, 6, 7],</span>
<span class="sd">               [9, 10, 11]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MapValid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">large_number</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>

    <span class="k">elif</span> <span class="ow">not</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span><span class="o">.</span><span class="n">isnumeric</span><span class="p">()</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices_</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">where</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">...</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="s2">&quot;The chosen mask </span><span class="si">{}</span><span class="s2"> does not fit in any supported case&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mask</span>
            <span class="p">)</span>
        <span class="p">)</span>

    <span class="n">samples_dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">valid_indices</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">samples_dim</span><span class="p">),)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices_</span>

    <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.MapValid.prepare_input_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.MapValid.prepare_input_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>This function is used to prepare structured input data for further processing.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.recarray">recarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>This function is a wrapper function that calls the 'prepare_input_data' function internally.</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data = np.array([(1, 2, 3), (4, 5, 6)], dtype=[('a', int), ('b', int), ('c', int)])
&gt;&gt;&gt; model = MapValid()
&gt;&gt;&gt; prepared_data = MapValid.prepare_input_structured_data(data)
&gt;&gt;&gt; prepared_data
array([[1, 2, 3],
      [4, 5, 6]])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">657</span>
<span class="normal">658</span>
<span class="normal">659</span>
<span class="normal">660</span>
<span class="normal">661</span>
<span class="normal">662</span>
<span class="normal">663</span>
<span class="normal">664</span>
<span class="normal">665</span>
<span class="normal">666</span>
<span class="normal">667</span>
<span class="normal">668</span>
<span class="normal">669</span>
<span class="normal">670</span>
<span class="normal">671</span>
<span class="normal">672</span>
<span class="normal">673</span>
<span class="normal">674</span>
<span class="normal">675</span>
<span class="normal">676</span>
<span class="normal">677</span>
<span class="normal">678</span>
<span class="normal">679</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function is used to prepare structured input data for further processing.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.recarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        This function is a wrapper function that calls the &#39;prepare_input_data&#39; function internally.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = np.array([(1, 2, 3), (4, 5, 6)], dtype=[(&#39;a&#39;, int), (&#39;b&#39;, int), (&#39;c&#39;, int)])</span>
<span class="sd">        &gt;&gt;&gt; model = MapValid()</span>
<span class="sd">        &gt;&gt;&gt; prepared_data = MapValid.prepare_input_structured_data(data)</span>
<span class="sd">        &gt;&gt;&gt; prepared_data</span>
<span class="sd">        array([[1, 2, 3],</span>
<span class="sd">              [4, 5, 6]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.MapValid.prepare_output_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_output_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.MapValid.prepare_output_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare output data for the MapValid operation.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The reshaped data will have shape (n0, n_valids) where n0 is the number of samples and n_valids are the number of valid values in the data.</li>
<li>If the return_the_same_mask attribute is set to True, the mask used to select the invalid values will be returned. Otherwise, the reshaped data will be filled with NaN.</li>
</ul>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; reshaper = MapValid()
&gt;&gt;&gt; data = np.array([[[1, 2, 3], [4, 5, 6]], [[7, 8, 9], [10, 11, 12]]])
&gt;&gt;&gt; reshaper.prepare_output_data(data)
array([[[ 1.,  2.,  3.],
        [ 4.,  5.,  6.]],
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">610</span>
<span class="normal">611</span>
<span class="normal">612</span>
<span class="normal">613</span>
<span class="normal">614</span>
<span class="normal">615</span>
<span class="normal">616</span>
<span class="normal">617</span>
<span class="normal">618</span>
<span class="normal">619</span>
<span class="normal">620</span>
<span class="normal">621</span>
<span class="normal">622</span>
<span class="normal">623</span>
<span class="normal">624</span>
<span class="normal">625</span>
<span class="normal">626</span>
<span class="normal">627</span>
<span class="normal">628</span>
<span class="normal">629</span>
<span class="normal">630</span>
<span class="normal">631</span>
<span class="normal">632</span>
<span class="normal">633</span>
<span class="normal">634</span>
<span class="normal">635</span>
<span class="normal">636</span>
<span class="normal">637</span>
<span class="normal">638</span>
<span class="normal">639</span>
<span class="normal">640</span>
<span class="normal">641</span>
<span class="normal">642</span>
<span class="normal">643</span>
<span class="normal">644</span>
<span class="normal">645</span>
<span class="normal">646</span>
<span class="normal">647</span>
<span class="normal">648</span>
<span class="normal">649</span>
<span class="normal">650</span>
<span class="normal">651</span>
<span class="normal">652</span>
<span class="normal">653</span>
<span class="normal">654</span>
<span class="normal">655</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_output_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare output data for the MapValid operation.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        - The reshaped data will have shape (n0, n_valids) where n0 is the number of samples and n_valids are the number of valid values in the data.</span>
<span class="sd">        - If the return_the_same_mask attribute is set to True, the mask used to select the invalid values will be returned. Otherwise, the reshaped data will be filled with NaN.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; reshaper = MapValid()</span>
<span class="sd">        &gt;&gt;&gt; data = np.array([[[1, 2, 3], [4, 5, 6]], [[7, 8, 9], [10, 11, 12]]])</span>
<span class="sd">        &gt;&gt;&gt; reshaper.prepare_output_data(data)</span>
<span class="sd">        array([[[ 1.,  2.,  3.],</span>
<span class="sd">                [ 4.,  5.,  6.]],</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">immutable_shape</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">final_shape</span> <span class="o">=</span> <span class="p">(</span>
        <span class="n">immutable_shape</span><span class="p">,</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">n_features</span><span class="p">,</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">return_the_same_mask</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mask_</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">NaN</span>  <span class="c1"># For practical purposes</span>
    <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="n">final_shape</span><span class="p">,</span> <span class="n">mask</span><span class="p">)</span>

    <span class="k">if</span> <span class="ow">not</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="bp">self</span><span class="o">.</span><span class="n">default_dtype</span><span class="p">:</span>
        <span class="n">reshaped_data</span> <span class="o">=</span> <span class="n">reshaped_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">default_dtype</span><span class="p">)</span>

    <span class="n">samples_dim</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">valid_indices</span> <span class="o">=</span> <span class="p">(</span><span class="nb">slice</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">samples_dim</span><span class="p">),)</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">valid_indices_</span>

    <span class="n">reshaped_data</span><span class="p">[</span><span class="n">valid_indices</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span>

    <span class="n">reshaped_data</span> <span class="o">=</span> <span class="nb">super</span><span class="p">(</span><span class="n">MapValid</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">prepare_output_data</span><span class="p">(</span><span class="n">reshaped_data</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">reshaped_data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.MapValid.prepare_output_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_output_structured_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.MapValid.prepare_output_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>This function is used to prepare structured output data for further processing.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>This function is a wrapper function that calls the 'prepare_output_data' function internally.</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6]])
&gt;&gt;&gt; model = MapValid()
&gt;&gt;&gt; prepared_data = MapValid.prepare_output_structured_data(data)
&gt;&gt;&gt; prepared_data
array([[1, 2, 3],
    [4, 5, 6]])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">681</span>
<span class="normal">682</span>
<span class="normal">683</span>
<span class="normal">684</span>
<span class="normal">685</span>
<span class="normal">686</span>
<span class="normal">687</span>
<span class="normal">688</span>
<span class="normal">689</span>
<span class="normal">690</span>
<span class="normal">691</span>
<span class="normal">692</span>
<span class="normal">693</span>
<span class="normal">694</span>
<span class="normal">695</span>
<span class="normal">696</span>
<span class="normal">697</span>
<span class="normal">698</span>
<span class="normal">699</span>
<span class="normal">700</span>
<span class="normal">701</span>
<span class="normal">702</span>
<span class="normal">703</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_output_structured_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This function is used to prepare structured output data for further processing.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        This function is a wrapper function that calls the &#39;prepare_output_data&#39; function internally.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6]])</span>
<span class="sd">        &gt;&gt;&gt; model = MapValid()</span>
<span class="sd">        &gt;&gt;&gt; prepared_data = MapValid.prepare_output_structured_data(data)</span>
<span class="sd">        &gt;&gt;&gt; prepared_data</span>
<span class="sd">        array([[1, 2, 3],</span>
<span class="sd">            [4, 5, 6]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">prepare_output_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="sampling"><red>Sampling </red><a class="headerlink" href="#sampling" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.Sampling"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="simulai.abstract.DataPreparer">DataPreparer</span></code></p>

  
      <p>This class is used for sampling data from the input dataset.</p>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">706</span>
<span class="normal">707</span>
<span class="normal">708</span>
<span class="normal">709</span>
<span class="normal">710</span>
<span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span>
<span class="normal">725</span>
<span class="normal">726</span>
<span class="normal">727</span>
<span class="normal">728</span>
<span class="normal">729</span>
<span class="normal">730</span>
<span class="normal">731</span>
<span class="normal">732</span>
<span class="normal">733</span>
<span class="normal">734</span>
<span class="normal">735</span>
<span class="normal">736</span>
<span class="normal">737</span>
<span class="normal">738</span>
<span class="normal">739</span>
<span class="normal">740</span>
<span class="normal">741</span>
<span class="normal">742</span>
<span class="normal">743</span>
<span class="normal">744</span>
<span class="normal">745</span>
<span class="normal">746</span>
<span class="normal">747</span>
<span class="normal">748</span>
<span class="normal">749</span>
<span class="normal">750</span>
<span class="normal">751</span>
<span class="normal">752</span>
<span class="normal">753</span>
<span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span>
<span class="normal">791</span>
<span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Sampling</span><span class="p">(</span><span class="n">DataPreparer</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;This class is used for sampling data from the input dataset.&quot;&quot;&quot;</span>

    <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;sampling&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choices_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">shuffling</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initializes the Sampling class.</span>

<span class="sd">        Args:</span>
<span class="sd">            choices_fraction (float, optional): The fraction of the dataset to be sampled, by default 0.1</span>
<span class="sd">            shuffling (bool, optional): Whether to shuffle the data before sampling, by default False</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">choices_fraction</span> <span class="o">=</span> <span class="n">choices_fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shuffling</span> <span class="o">=</span> <span class="n">shuffling</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="kc">None</span>

    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">indices</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">list</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns the indices of the data that have been sampled.</span>

<span class="sd">        Returns:</span>
<span class="sd">            list: The indices of the data that have been sampled.</span>

<span class="sd">        Raises:</span>
<span class="sd">            AssertionError: If the indices have not been generated yet.</span>

<span class="sd">        Note:</span>
<span class="sd">            The indices are generated by calling the &#39;prepare_input_data&#39; or &#39;prepare_input_structured_data&#39; functions.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; import numpy as np</span>
<span class="sd">            &gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<span class="sd">            &gt;&gt;&gt; sampler = Sampling(choices_fraction=0.5, shuffling=True)</span>
<span class="sd">            &gt;&gt;&gt; sampler.prepare_input_data(data)</span>
<span class="sd">            &gt;&gt;&gt; sampler.indices</span>
<span class="sd">            [0, 1]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">,</span> <span class="p">(</span>
            <span class="s2">&quot;The indices still were not generate.&quot;</span>
            <span class="s2">&quot;Run prepare_input_data or prepare_input_structured_data for getting them.&quot;</span>
        <span class="p">)</span>
        <span class="k">return</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="o">.</span><span class="n">tolist</span><span class="p">())</span>

    <span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">data_interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepare input data for sampling.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (np.ndarray, optional): The input data. Default is None.</span>
<span class="sd">            data_interval (list, optional): The interval of data that should be selected. Default is None,</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray: The sampled data.</span>
<span class="sd">        Note:</span>
<span class="sd">            The `data_interval` parameter must be a list of two integers, specifying the start and end of the interval.</span>
<span class="sd">         Example:</span>

<span class="sd">            &gt;&gt;&gt; data = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<span class="sd">            &gt;&gt;&gt; data_interval = [3, 7]</span>
<span class="sd">            &gt;&gt;&gt; input_data = sampler.prepare_input_data(data, data_interval)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">data_interval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_interval</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">n_choices</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices_fraction</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffling</span><span class="p">:</span>
            <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="p">,</span> <span class="n">n_choices</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data_interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dump_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Prepares structured data for further processing.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (h5py.Dataset, optional): Structured array to be prepared, the default shape is (n_samples, 1, *other_dimensions)</span>
<span class="sd">            data_interval (list, optional): The interval of the data to be prepared, the default shape is [0, data.shape[0]]</span>
<span class="sd">            batch_size (int, optional): The size of the batches to be processed, defaults to None</span>
<span class="sd">            dump_path (str, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.recarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            - The features dimensions of the input data should be 1 in NumPy structured arrays.</span>
<span class="sd">            - When using a h5py.Dataset as input, a dump_path must be provided</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = h5py.File(&quot;path/to/data.h5&quot;, &#39;r&#39;)[&#39;data&#39;]</span>
<span class="sd">            &gt;&gt;&gt; data_interval = [0, data.shape[0]]</span>
<span class="sd">            &gt;&gt;&gt; batch_size = 32</span>
<span class="sd">            &gt;&gt;&gt; dump_path = &quot;path/to/dump.h5&quot;</span>
<span class="sd">            &gt;&gt;&gt; obj = PrepareInputStructuredData()</span>
<span class="sd">            &gt;&gt;&gt; prepared_data = obj.prepare_input_structured_data(data, data_interval, batch_size, dump_path)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">data_interval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data_interval</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

        <span class="n">n_samples</span> <span class="o">=</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

        <span class="n">n_sampled_preserved</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices_fraction</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span><span class="p">,</span> <span class="n">n_sampled_preserved</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">MemorySizeEval</span><span class="p">):</span>
                <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">(</span>
                    <span class="n">max_batches</span><span class="o">=</span><span class="n">n_sampled_preserved</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="k">assert</span> <span class="p">(</span>
                <span class="n">dump_path</span>
            <span class="p">),</span> <span class="s2">&quot;Using a h5py.Dataset as input data a dump_path must be provided.&quot;</span>

            <span class="n">fp</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">dump_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
            <span class="n">sampled_data</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
                <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_sampled_preserved</span><span class="p">,)</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
            <span class="p">)</span>

            <span class="c1"># Constructing the normalization  using the reference data</span>
            <span class="n">batches</span> <span class="o">=</span> <span class="n">indices_batchdomain_constructor</span><span class="p">(</span>
                <span class="n">indices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span>
            <span class="p">)</span>

            <span class="n">start_ix</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">batch_id</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batches</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span>
                    <span class="sa">f</span><span class="s2">&quot;Sampling batch </span><span class="si">{</span><span class="n">batch_id</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span><span class="si">}</span><span class="s2"> batch_size=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="p">)</span>
                <span class="n">finish_ix</span> <span class="o">=</span> <span class="n">start_ix</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
                <span class="n">sampled_data</span><span class="p">[</span><span class="n">start_ix</span><span class="p">:</span><span class="n">finish_ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">sorted</span><span class="p">(</span><span class="n">batch</span><span class="p">)]</span>
                <span class="n">start_ix</span> <span class="o">=</span> <span class="n">finish_ix</span>

            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffling</span><span class="p">:</span>
                <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sampled_data</span><span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Others cases are still not implemented.&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">sampled_data</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">







<div class="doc doc-object doc-attribute">




<h2 id="simulai.io.Sampling.indices" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">indices</span><span class="p">:</span> <span class="nb">list</span></code>
  
  <span class="doc doc-labels">
      <small class="doc doc-label doc-label-property"><code>property</code></small>
  </span>

<a href="#simulai.io.Sampling.indices" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Returns the indices of the data that have been sampled.</p>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
<th>Name</th>        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
<td><code>list</code></td>          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The indices of the data that have been sampled.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>AssertionError</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>If the indices have not been generated yet.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>The indices are generated by calling the 'prepare_input_data' or 'prepare_input_structured_data' functions.</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
&gt;&gt;&gt; sampler = Sampling(choices_fraction=0.5, shuffling=True)
&gt;&gt;&gt; sampler.prepare_input_data(data)
&gt;&gt;&gt; sampler.indices
[0, 1]
</code></pre>
  </div>

</div>




<div class="doc doc-object doc-function">




<h2 id="simulai.io.Sampling.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">choices_fraction</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">shuffling</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span></code>

<a href="#simulai.io.Sampling.__init__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Initializes the Sampling class.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>choices_fraction</code></td>
          <td>
                <code>float</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The fraction of the dataset to be sampled, by default 0.1</p>
            </div>
          </td>
          <td>
                <code>0.1</code>
          </td>
        </tr>
        <tr>
          <td><code>shuffling</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to shuffle the data before sampling, by default False</p>
            </div>
          </td>
          <td>
                <code>False</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">711</span>
<span class="normal">712</span>
<span class="normal">713</span>
<span class="normal">714</span>
<span class="normal">715</span>
<span class="normal">716</span>
<span class="normal">717</span>
<span class="normal">718</span>
<span class="normal">719</span>
<span class="normal">720</span>
<span class="normal">721</span>
<span class="normal">722</span>
<span class="normal">723</span>
<span class="normal">724</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">choices_fraction</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span> <span class="n">shuffling</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Initializes the Sampling class.</span>

<span class="sd">    Args:</span>
<span class="sd">        choices_fraction (float, optional): The fraction of the dataset to be sampled, by default 0.1</span>
<span class="sd">        shuffling (bool, optional): Whether to shuffle the data before sampling, by default False</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">choices_fraction</span> <span class="o">=</span> <span class="n">choices_fraction</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">shuffling</span> <span class="o">=</span> <span class="n">shuffling</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="kc">None</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.Sampling.prepare_input_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.Sampling.prepare_input_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepare input data for sampling.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The input data. Default is None.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>data_interval</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The interval of data that should be selected. Default is None,</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>numpy.ndarray: The sampled data.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Note:
    The <code>data_interval</code> parameter must be a list of two integers, specifying the start and end of the interval.
 Example:</p>
<pre><code>&gt;&gt;&gt; data = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
&gt;&gt;&gt; data_interval = [3, 7]
&gt;&gt;&gt; input_data = sampler.prepare_input_data(data, data_interval)
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">754</span>
<span class="normal">755</span>
<span class="normal">756</span>
<span class="normal">757</span>
<span class="normal">758</span>
<span class="normal">759</span>
<span class="normal">760</span>
<span class="normal">761</span>
<span class="normal">762</span>
<span class="normal">763</span>
<span class="normal">764</span>
<span class="normal">765</span>
<span class="normal">766</span>
<span class="normal">767</span>
<span class="normal">768</span>
<span class="normal">769</span>
<span class="normal">770</span>
<span class="normal">771</span>
<span class="normal">772</span>
<span class="normal">773</span>
<span class="normal">774</span>
<span class="normal">775</span>
<span class="normal">776</span>
<span class="normal">777</span>
<span class="normal">778</span>
<span class="normal">779</span>
<span class="normal">780</span>
<span class="normal">781</span>
<span class="normal">782</span>
<span class="normal">783</span>
<span class="normal">784</span>
<span class="normal">785</span>
<span class="normal">786</span>
<span class="normal">787</span>
<span class="normal">788</span>
<span class="normal">789</span>
<span class="normal">790</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">data_interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepare input data for sampling.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (np.ndarray, optional): The input data. Default is None.</span>
<span class="sd">        data_interval (list, optional): The interval of data that should be selected. Default is None,</span>

<span class="sd">    Returns:</span>
<span class="sd">        numpy.ndarray: The sampled data.</span>
<span class="sd">    Note:</span>
<span class="sd">        The `data_interval` parameter must be a list of two integers, specifying the start and end of the interval.</span>
<span class="sd">     Example:</span>

<span class="sd">        &gt;&gt;&gt; data = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<span class="sd">        &gt;&gt;&gt; data_interval = [3, 7]</span>
<span class="sd">        &gt;&gt;&gt; input_data = sampler.prepare_input_data(data, data_interval)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data_interval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_interval</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
    <span class="n">n_samples</span> <span class="o">=</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">n_choices</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices_fraction</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffling</span><span class="p">:</span>
        <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="p">,</span> <span class="n">n_choices</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="p">]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.Sampling.prepare_input_structured_data" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">prepare_input_structured_data</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dump_path</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.Sampling.prepare_input_structured_data" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Prepares structured data for further processing.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="h5py.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Structured array to be prepared, the default shape is (n_samples, 1, *other_dimensions)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>data_interval</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The interval of the data to be prepared, the default shape is [0, data.shape[0]]</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The size of the batches to be processed, defaults to None</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dump_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.recarray">recarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.recarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>The features dimensions of the input data should be 1 in NumPy structured arrays.</li>
<li>When using a h5py.Dataset as input, a dump_path must be provided</li>
</ul>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; data = h5py.File("path/to/data.h5", 'r')['data']
&gt;&gt;&gt; data_interval = [0, data.shape[0]]
&gt;&gt;&gt; batch_size = 32
&gt;&gt;&gt; dump_path = "path/to/dump.h5"
&gt;&gt;&gt; obj = PrepareInputStructuredData()
&gt;&gt;&gt; prepared_data = obj.prepare_input_structured_data(data, data_interval, batch_size, dump_path)
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">792</span>
<span class="normal">793</span>
<span class="normal">794</span>
<span class="normal">795</span>
<span class="normal">796</span>
<span class="normal">797</span>
<span class="normal">798</span>
<span class="normal">799</span>
<span class="normal">800</span>
<span class="normal">801</span>
<span class="normal">802</span>
<span class="normal">803</span>
<span class="normal">804</span>
<span class="normal">805</span>
<span class="normal">806</span>
<span class="normal">807</span>
<span class="normal">808</span>
<span class="normal">809</span>
<span class="normal">810</span>
<span class="normal">811</span>
<span class="normal">812</span>
<span class="normal">813</span>
<span class="normal">814</span>
<span class="normal">815</span>
<span class="normal">816</span>
<span class="normal">817</span>
<span class="normal">818</span>
<span class="normal">819</span>
<span class="normal">820</span>
<span class="normal">821</span>
<span class="normal">822</span>
<span class="normal">823</span>
<span class="normal">824</span>
<span class="normal">825</span>
<span class="normal">826</span>
<span class="normal">827</span>
<span class="normal">828</span>
<span class="normal">829</span>
<span class="normal">830</span>
<span class="normal">831</span>
<span class="normal">832</span>
<span class="normal">833</span>
<span class="normal">834</span>
<span class="normal">835</span>
<span class="normal">836</span>
<span class="normal">837</span>
<span class="normal">838</span>
<span class="normal">839</span>
<span class="normal">840</span>
<span class="normal">841</span>
<span class="normal">842</span>
<span class="normal">843</span>
<span class="normal">844</span>
<span class="normal">845</span>
<span class="normal">846</span>
<span class="normal">847</span>
<span class="normal">848</span>
<span class="normal">849</span>
<span class="normal">850</span>
<span class="normal">851</span>
<span class="normal">852</span>
<span class="normal">853</span>
<span class="normal">854</span>
<span class="normal">855</span>
<span class="normal">856</span>
<span class="normal">857</span>
<span class="normal">858</span>
<span class="normal">859</span>
<span class="normal">860</span>
<span class="normal">861</span>
<span class="normal">862</span>
<span class="normal">863</span>
<span class="normal">864</span>
<span class="normal">865</span>
<span class="normal">866</span>
<span class="normal">867</span>
<span class="normal">868</span>
<span class="normal">869</span>
<span class="normal">870</span>
<span class="normal">871</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">prepare_input_structured_data</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">data_interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dump_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">recarray</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Prepares structured data for further processing.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (h5py.Dataset, optional): Structured array to be prepared, the default shape is (n_samples, 1, *other_dimensions)</span>
<span class="sd">        data_interval (list, optional): The interval of the data to be prepared, the default shape is [0, data.shape[0]]</span>
<span class="sd">        batch_size (int, optional): The size of the batches to be processed, defaults to None</span>
<span class="sd">        dump_path (str, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.recarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        - The features dimensions of the input data should be 1 in NumPy structured arrays.</span>
<span class="sd">        - When using a h5py.Dataset as input, a dump_path must be provided</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = h5py.File(&quot;path/to/data.h5&quot;, &#39;r&#39;)[&#39;data&#39;]</span>
<span class="sd">        &gt;&gt;&gt; data_interval = [0, data.shape[0]]</span>
<span class="sd">        &gt;&gt;&gt; batch_size = 32</span>
<span class="sd">        &gt;&gt;&gt; dump_path = &quot;path/to/dump.h5&quot;</span>
<span class="sd">        &gt;&gt;&gt; obj = PrepareInputStructuredData()</span>
<span class="sd">        &gt;&gt;&gt; prepared_data = obj.prepare_input_structured_data(data, data_interval, batch_size, dump_path)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="n">data_interval</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">data_interval</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>

    <span class="n">n_samples</span> <span class="o">=</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">start</span><span class="o">=</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">stop</span><span class="o">=</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">n_sampled_preserved</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">choices_fraction</span> <span class="o">*</span> <span class="n">n_samples</span><span class="p">)</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">(</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">global_indices</span><span class="p">,</span> <span class="n">n_sampled_preserved</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">False</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">MemorySizeEval</span><span class="p">):</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">(</span>
                <span class="n">max_batches</span><span class="o">=</span><span class="n">n_sampled_preserved</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
            <span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">dump_path</span>
        <span class="p">),</span> <span class="s2">&quot;Using a h5py.Dataset as input data a dump_path must be provided.&quot;</span>

        <span class="n">fp</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">dump_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">sampled_data</span> <span class="o">=</span> <span class="n">fp</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span>
            <span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="n">n_sampled_preserved</span><span class="p">,)</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span>
        <span class="p">)</span>

        <span class="c1"># Constructing the normalization  using the reference data</span>
        <span class="n">batches</span> <span class="o">=</span> <span class="n">indices_batchdomain_constructor</span><span class="p">(</span>
            <span class="n">indices</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">sampled_indices</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span>
        <span class="p">)</span>

        <span class="n">start_ix</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">batch_id</span><span class="p">,</span> <span class="n">batch</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">batches</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Sampling batch </span><span class="si">{</span><span class="n">batch_id</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span><span class="si">}</span><span class="s2"> batch_size=</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>
            <span class="n">finish_ix</span> <span class="o">=</span> <span class="n">start_ix</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span>
            <span class="n">sampled_data</span><span class="p">[</span><span class="n">start_ix</span><span class="p">:</span><span class="n">finish_ix</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">sorted</span><span class="p">(</span><span class="n">batch</span><span class="p">)]</span>
            <span class="n">start_ix</span> <span class="o">=</span> <span class="n">finish_ix</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">shuffling</span><span class="p">:</span>
            <span class="n">random</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">sampled_data</span><span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Others cases are still not implemented.&quot;</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">sampled_data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="movingwindow"><red>MovingWindow</red><a class="headerlink" href="#movingwindow" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.MovingWindow"></a>
  <div class="doc doc-contents first">

  
      <p>MovingWindow is applied over a time-series array (2D array), and it is used for
creating the necessary augmented data used for LSTM networks, replicating the training
windows for each sample in the dataset.</p>
<p>See a graphical example:</p>
<p>Example:</p>
<pre><code>batch n
---------|---
history  | horizon

    batch n+1
    ---------|---
    history  | horizon
----
skip
</code></pre>
<p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; data = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])
&gt;&gt;&gt; window = MovingWindow(history_size=3, horizon_size=1)
&gt;&gt;&gt; window.transform(data)
array([[1, 2, 3],
       [2, 3, 4],
       [3, 4, 5],
       [4, 5, 6],
       [5, 6, 7],
       [6, 7, 8],
       [7, 8, 9],
       [8, 9, 10]])
</code></pre>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 874</span>
<span class="normal"> 875</span>
<span class="normal"> 876</span>
<span class="normal"> 877</span>
<span class="normal"> 878</span>
<span class="normal"> 879</span>
<span class="normal"> 880</span>
<span class="normal"> 881</span>
<span class="normal"> 882</span>
<span class="normal"> 883</span>
<span class="normal"> 884</span>
<span class="normal"> 885</span>
<span class="normal"> 886</span>
<span class="normal"> 887</span>
<span class="normal"> 888</span>
<span class="normal"> 889</span>
<span class="normal"> 890</span>
<span class="normal"> 891</span>
<span class="normal"> 892</span>
<span class="normal"> 893</span>
<span class="normal"> 894</span>
<span class="normal"> 895</span>
<span class="normal"> 896</span>
<span class="normal"> 897</span>
<span class="normal"> 898</span>
<span class="normal"> 899</span>
<span class="normal"> 900</span>
<span class="normal"> 901</span>
<span class="normal"> 902</span>
<span class="normal"> 903</span>
<span class="normal"> 904</span>
<span class="normal"> 905</span>
<span class="normal"> 906</span>
<span class="normal"> 907</span>
<span class="normal"> 908</span>
<span class="normal"> 909</span>
<span class="normal"> 910</span>
<span class="normal"> 911</span>
<span class="normal"> 912</span>
<span class="normal"> 913</span>
<span class="normal"> 914</span>
<span class="normal"> 915</span>
<span class="normal"> 916</span>
<span class="normal"> 917</span>
<span class="normal"> 918</span>
<span class="normal"> 919</span>
<span class="normal"> 920</span>
<span class="normal"> 921</span>
<span class="normal"> 922</span>
<span class="normal"> 923</span>
<span class="normal"> 924</span>
<span class="normal"> 925</span>
<span class="normal"> 926</span>
<span class="normal"> 927</span>
<span class="normal"> 928</span>
<span class="normal"> 929</span>
<span class="normal"> 930</span>
<span class="normal"> 931</span>
<span class="normal"> 932</span>
<span class="normal"> 933</span>
<span class="normal"> 934</span>
<span class="normal"> 935</span>
<span class="normal"> 936</span>
<span class="normal"> 937</span>
<span class="normal"> 938</span>
<span class="normal"> 939</span>
<span class="normal"> 940</span>
<span class="normal"> 941</span>
<span class="normal"> 942</span>
<span class="normal"> 943</span>
<span class="normal"> 944</span>
<span class="normal"> 945</span>
<span class="normal"> 946</span>
<span class="normal"> 947</span>
<span class="normal"> 948</span>
<span class="normal"> 949</span>
<span class="normal"> 950</span>
<span class="normal"> 951</span>
<span class="normal"> 952</span>
<span class="normal"> 953</span>
<span class="normal"> 954</span>
<span class="normal"> 955</span>
<span class="normal"> 956</span>
<span class="normal"> 957</span>
<span class="normal"> 958</span>
<span class="normal"> 959</span>
<span class="normal"> 960</span>
<span class="normal"> 961</span>
<span class="normal"> 962</span>
<span class="normal"> 963</span>
<span class="normal"> 964</span>
<span class="normal"> 965</span>
<span class="normal"> 966</span>
<span class="normal"> 967</span>
<span class="normal"> 968</span>
<span class="normal"> 969</span>
<span class="normal"> 970</span>
<span class="normal"> 971</span>
<span class="normal"> 972</span>
<span class="normal"> 973</span>
<span class="normal"> 974</span>
<span class="normal"> 975</span>
<span class="normal"> 976</span>
<span class="normal"> 977</span>
<span class="normal"> 978</span>
<span class="normal"> 979</span>
<span class="normal"> 980</span>
<span class="normal"> 981</span>
<span class="normal"> 982</span>
<span class="normal"> 983</span>
<span class="normal"> 984</span>
<span class="normal"> 985</span>
<span class="normal"> 986</span>
<span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MovingWindow</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;MovingWindow is applied over a time-series array (2D array), and it is used for</span>
<span class="sd">    creating the necessary augmented data used for LSTM networks, replicating the training</span>
<span class="sd">    windows for each sample in the dataset.</span>

<span class="sd">    See a graphical example:</span>

<span class="sd">    Example:</span>

<span class="sd">        batch n</span>
<span class="sd">        ---------|---</span>
<span class="sd">        history  | horizon</span>

<span class="sd">            batch n+1</span>
<span class="sd">            ---------|---</span>
<span class="sd">            history  | horizon</span>
<span class="sd">        ----</span>
<span class="sd">        skip</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; data = np.array([1, 2, 3, 4, 5, 6, 7, 8, 9, 10])</span>
<span class="sd">        &gt;&gt;&gt; window = MovingWindow(history_size=3, horizon_size=1)</span>
<span class="sd">        &gt;&gt;&gt; window.transform(data)</span>
<span class="sd">        array([[1, 2, 3],</span>
<span class="sd">               [2, 3, 4],</span>
<span class="sd">               [3, 4, 5],</span>
<span class="sd">               [4, 5, 6],</span>
<span class="sd">               [5, 6, 7],</span>
<span class="sd">               [6, 7, 8],</span>
<span class="sd">               [7, 8, 9],</span>
<span class="sd">               [8, 9, 10]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">history_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">skip_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
        <span class="n">horizon_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">full_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initializes the MovingWindow class</span>

<span class="sd">        Args:</span>
<span class="sd">            history_size (int, optional): the size of the history window, by default None</span>
<span class="sd">            skip_size (int, optional): the number of steps to skip between windows, by default 1</span>
<span class="sd">            horizon_size (int, optional): the size of the horizon window, by default None</span>
<span class="sd">            full_output (bool, optional): flag to use the full output or only the last item, by default True</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">=</span> <span class="n">history_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">=</span> <span class="n">skip_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">horizon_size</span> <span class="o">=</span> <span class="n">horizon_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full_output</span> <span class="o">=</span> <span class="n">full_output</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_output</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bypass</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">process_batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_item</span>

        <span class="c1"># Verifying if history and horizon sizes was provided</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">history_size</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;A value for history_size must be provided, not </span><span class="si">{</span><span class="n">history_size</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">horizon_size</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;A value for horizon_size must be provided, not </span><span class="si">{</span><span class="n">horizon_size</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Applies the moving window over the time_series array.</span>

<span class="sd">        Args:</span>
<span class="sd">            time_series (np.ndarray):</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: the transformed array with the windows.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">bypass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Does nothing, returns the input batch.</span>

<span class="sd">        Args:</span>
<span class="sd">            batch (np.ndarray):</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: the input array</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">batch</span>

    <span class="k">def</span> <span class="nf">get_last_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the last item of a batch</span>

<span class="sd">        Args:</span>
<span class="sd">            batch (np.ndarray):</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            - This method is used internally by the MovingWindow class</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<span class="sd">            &gt;&gt;&gt; mw.get_last_item(data)</span>
<span class="sd">            array([[7, 8, 9]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">batch</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Apply Moving Window over the input data</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data (np.ndarray, optional): 2D array (time-series) to be used for constructing the history size (Default value = None)</span>
<span class="sd">            output_data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple of np.ndarray: The tuple contains two arrays with shapes (n_samples, n_history, n_features) and</span>

<span class="sd">        Note:</span>
<span class="sd">            - It is expected that the input_data and output_data have the same shape</span>
<span class="sd">            - This method is used internally by the MovingWindow class</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12], [13, 14, 15]])</span>
<span class="sd">            &gt;&gt;&gt; mw = MovingWindow(history_size=2, horizon_size=2, skip_size=1)</span>
<span class="sd">            &gt;&gt;&gt; input_data, output_data = mw(data, data)</span>
<span class="sd">            &gt;&gt;&gt; input_data</span>
<span class="sd">            array([[[1, 2, 3],</span>
<span class="sd">                    [4, 5, 6]],</span>
<span class="sd">                   [[4, 5, 6],</span>
<span class="sd">                    [7, 8, 9]],</span>
<span class="sd">                   [[7, 8, 9],</span>
<span class="sd">                    [10, 11, 12]]])</span>
<span class="sd">            &gt;&gt;&gt; output_data</span>
<span class="sd">            array([[[ 7,  8,  9],</span>
<span class="sd">                    [10, 11, 12]],</span>
<span class="sd">                   [[10, 11, 12],</span>
<span class="sd">                    [13, 14, 15]]])</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># It is expected series_data to be a set of time-series with shape</span>
        <span class="c1"># (n_timesteps, n_variables)</span>

        <span class="n">input_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">output_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">data_size</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">assert</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">output_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span>

        <span class="c1"># Loop for covering the entire time-series dataset constructing the</span>
        <span class="c1"># training windows</span>
        <span class="k">while</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizon_size</span> <span class="o">&lt;=</span> <span class="n">data_size</span><span class="p">:</span>
            <span class="n">input_batch</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">center</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="p">:</span> <span class="n">center</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">output_batch</span> <span class="o">=</span> <span class="n">output_data</span><span class="p">[</span><span class="n">center</span> <span class="p">:</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizon_size</span><span class="p">,</span> <span class="p">:]</span>

            <span class="n">input_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
            <span class="n">output_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_batch</span><span class="p">(</span><span class="n">batch</span><span class="o">=</span><span class="n">output_batch</span><span class="p">))</span>

            <span class="n">center</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span>

        <span class="n">input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">input_batches_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">output_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">output_batches_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">output_data</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.MovingWindow.__call__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.MovingWindow.__call__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Apply Moving Window over the input data</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array (time-series) to be used for constructing the history size (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple of np.ndarray: The tuple contains two arrays with shapes (n_samples, n_history, n_features) and</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>It is expected that the input_data and output_data have the same shape</li>
<li>This method is used internally by the MovingWindow class</li>
</ul>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12], [13, 14, 15]])
&gt;&gt;&gt; mw = MovingWindow(history_size=2, horizon_size=2, skip_size=1)
&gt;&gt;&gt; input_data, output_data = mw(data, data)
&gt;&gt;&gt; input_data
array([[[1, 2, 3],
        [4, 5, 6]],
       [[4, 5, 6],
        [7, 8, 9]],
       [[7, 8, 9],
        [10, 11, 12]]])
&gt;&gt;&gt; output_data
array([[[ 7,  8,  9],
        [10, 11, 12]],
       [[10, 11, 12],
        [13, 14, 15]]])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal"> 987</span>
<span class="normal"> 988</span>
<span class="normal"> 989</span>
<span class="normal"> 990</span>
<span class="normal"> 991</span>
<span class="normal"> 992</span>
<span class="normal"> 993</span>
<span class="normal"> 994</span>
<span class="normal"> 995</span>
<span class="normal"> 996</span>
<span class="normal"> 997</span>
<span class="normal"> 998</span>
<span class="normal"> 999</span>
<span class="normal">1000</span>
<span class="normal">1001</span>
<span class="normal">1002</span>
<span class="normal">1003</span>
<span class="normal">1004</span>
<span class="normal">1005</span>
<span class="normal">1006</span>
<span class="normal">1007</span>
<span class="normal">1008</span>
<span class="normal">1009</span>
<span class="normal">1010</span>
<span class="normal">1011</span>
<span class="normal">1012</span>
<span class="normal">1013</span>
<span class="normal">1014</span>
<span class="normal">1015</span>
<span class="normal">1016</span>
<span class="normal">1017</span>
<span class="normal">1018</span>
<span class="normal">1019</span>
<span class="normal">1020</span>
<span class="normal">1021</span>
<span class="normal">1022</span>
<span class="normal">1023</span>
<span class="normal">1024</span>
<span class="normal">1025</span>
<span class="normal">1026</span>
<span class="normal">1027</span>
<span class="normal">1028</span>
<span class="normal">1029</span>
<span class="normal">1030</span>
<span class="normal">1031</span>
<span class="normal">1032</span>
<span class="normal">1033</span>
<span class="normal">1034</span>
<span class="normal">1035</span>
<span class="normal">1036</span>
<span class="normal">1037</span>
<span class="normal">1038</span>
<span class="normal">1039</span>
<span class="normal">1040</span>
<span class="normal">1041</span>
<span class="normal">1042</span>
<span class="normal">1043</span>
<span class="normal">1044</span>
<span class="normal">1045</span>
<span class="normal">1046</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Apply Moving Window over the input data</span>

<span class="sd">    Args:</span>
<span class="sd">        input_data (np.ndarray, optional): 2D array (time-series) to be used for constructing the history size (Default value = None)</span>
<span class="sd">        output_data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple of np.ndarray: The tuple contains two arrays with shapes (n_samples, n_history, n_features) and</span>

<span class="sd">    Note:</span>
<span class="sd">        - It is expected that the input_data and output_data have the same shape</span>
<span class="sd">        - This method is used internally by the MovingWindow class</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9], [10, 11, 12], [13, 14, 15]])</span>
<span class="sd">        &gt;&gt;&gt; mw = MovingWindow(history_size=2, horizon_size=2, skip_size=1)</span>
<span class="sd">        &gt;&gt;&gt; input_data, output_data = mw(data, data)</span>
<span class="sd">        &gt;&gt;&gt; input_data</span>
<span class="sd">        array([[[1, 2, 3],</span>
<span class="sd">                [4, 5, 6]],</span>
<span class="sd">               [[4, 5, 6],</span>
<span class="sd">                [7, 8, 9]],</span>
<span class="sd">               [[7, 8, 9],</span>
<span class="sd">                [10, 11, 12]]])</span>
<span class="sd">        &gt;&gt;&gt; output_data</span>
<span class="sd">        array([[[ 7,  8,  9],</span>
<span class="sd">                [10, 11, 12]],</span>
<span class="sd">               [[10, 11, 12],</span>
<span class="sd">                [13, 14, 15]]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># It is expected series_data to be a set of time-series with shape</span>
    <span class="c1"># (n_timesteps, n_variables)</span>

    <span class="n">input_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">output_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">data_size</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">output_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span>

    <span class="c1"># Loop for covering the entire time-series dataset constructing the</span>
    <span class="c1"># training windows</span>
    <span class="k">while</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizon_size</span> <span class="o">&lt;=</span> <span class="n">data_size</span><span class="p">:</span>
        <span class="n">input_batch</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">center</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="p">:</span> <span class="n">center</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">output_batch</span> <span class="o">=</span> <span class="n">output_data</span><span class="p">[</span><span class="n">center</span> <span class="p">:</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizon_size</span><span class="p">,</span> <span class="p">:]</span>

        <span class="n">input_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
        <span class="n">output_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">process_batch</span><span class="p">(</span><span class="n">batch</span><span class="o">=</span><span class="n">output_batch</span><span class="p">))</span>

        <span class="n">center</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span>

    <span class="n">input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">input_batches_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">output_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">output_batches_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">output_data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.MovingWindow.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">history_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skip_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#simulai.io.MovingWindow.__init__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Initializes the MovingWindow class</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>history_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the history window, by default None</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>skip_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the number of steps to skip between windows, by default 1</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>horizon_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the horizon window, by default None</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>full_output</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>flag to use the full output or only the last item, by default True</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">909</span>
<span class="normal">910</span>
<span class="normal">911</span>
<span class="normal">912</span>
<span class="normal">913</span>
<span class="normal">914</span>
<span class="normal">915</span>
<span class="normal">916</span>
<span class="normal">917</span>
<span class="normal">918</span>
<span class="normal">919</span>
<span class="normal">920</span>
<span class="normal">921</span>
<span class="normal">922</span>
<span class="normal">923</span>
<span class="normal">924</span>
<span class="normal">925</span>
<span class="normal">926</span>
<span class="normal">927</span>
<span class="normal">928</span>
<span class="normal">929</span>
<span class="normal">930</span>
<span class="normal">931</span>
<span class="normal">932</span>
<span class="normal">933</span>
<span class="normal">934</span>
<span class="normal">935</span>
<span class="normal">936</span>
<span class="normal">937</span>
<span class="normal">938</span>
<span class="normal">939</span>
<span class="normal">940</span>
<span class="normal">941</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">history_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">skip_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span>
    <span class="n">horizon_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">full_output</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initializes the MovingWindow class</span>

<span class="sd">    Args:</span>
<span class="sd">        history_size (int, optional): the size of the history window, by default None</span>
<span class="sd">        skip_size (int, optional): the number of steps to skip between windows, by default 1</span>
<span class="sd">        horizon_size (int, optional): the size of the horizon window, by default None</span>
<span class="sd">        full_output (bool, optional): flag to use the full output or only the last item, by default True</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">=</span> <span class="n">history_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">=</span> <span class="n">skip_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">horizon_size</span> <span class="o">=</span> <span class="n">horizon_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">full_output</span> <span class="o">=</span> <span class="n">full_output</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">full_output</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bypass</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">process_batch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_last_item</span>

    <span class="c1"># Verifying if history and horizon sizes was provided</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">history_size</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;A value for history_size must be provided, not </span><span class="si">{</span><span class="n">history_size</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">horizon_size</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;A value for horizon_size must be provided, not </span><span class="si">{</span><span class="n">horizon_size</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.MovingWindow.bypass" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">bypass</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#simulai.io.MovingWindow.bypass" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Does nothing, returns the input batch.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>batch</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray: the input array</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">955</span>
<span class="normal">956</span>
<span class="normal">957</span>
<span class="normal">958</span>
<span class="normal">959</span>
<span class="normal">960</span>
<span class="normal">961</span>
<span class="normal">962</span>
<span class="normal">963</span>
<span class="normal">964</span>
<span class="normal">965</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">bypass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Does nothing, returns the input batch.</span>

<span class="sd">    Args:</span>
<span class="sd">        batch (np.ndarray):</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: the input array</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">batch</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.MovingWindow.get_last_item" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_last_item</span><span class="p">(</span><span class="n">batch</span><span class="p">)</span></code>

<a href="#simulai.io.MovingWindow.get_last_item" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Get the last item of a batch</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>batch</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>This method is used internally by the MovingWindow class</li>
</ul>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])
&gt;&gt;&gt; mw.get_last_item(data)
array([[7, 8, 9]])
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">967</span>
<span class="normal">968</span>
<span class="normal">969</span>
<span class="normal">970</span>
<span class="normal">971</span>
<span class="normal">972</span>
<span class="normal">973</span>
<span class="normal">974</span>
<span class="normal">975</span>
<span class="normal">976</span>
<span class="normal">977</span>
<span class="normal">978</span>
<span class="normal">979</span>
<span class="normal">980</span>
<span class="normal">981</span>
<span class="normal">982</span>
<span class="normal">983</span>
<span class="normal">984</span>
<span class="normal">985</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_last_item</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Get the last item of a batch</span>

<span class="sd">    Args:</span>
<span class="sd">        batch (np.ndarray):</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        - This method is used internally by the MovingWindow class</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = np.array([[1, 2, 3], [4, 5, 6], [7, 8, 9]])</span>
<span class="sd">        &gt;&gt;&gt; mw.get_last_item(data)</span>
<span class="sd">        array([[7, 8, 9]])</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="n">batch</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.MovingWindow.transform" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">transform</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span></code>

<a href="#simulai.io.MovingWindow.transform" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the moving window over the time_series array.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_series</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray: the transformed array with the windows.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">943</span>
<span class="normal">944</span>
<span class="normal">945</span>
<span class="normal">946</span>
<span class="normal">947</span>
<span class="normal">948</span>
<span class="normal">949</span>
<span class="normal">950</span>
<span class="normal">951</span>
<span class="normal">952</span>
<span class="normal">953</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">transform</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Applies the moving window over the time_series array.</span>

<span class="sd">    Args:</span>
<span class="sd">        time_series (np.ndarray):</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: the transformed array with the windows.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="slidingwindow"><red>SlidingWindow</red><a class="headerlink" href="#slidingwindow" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.SlidingWindow"></a>
  <div class="doc doc-contents first">

  
      <p>SlidingWindow is applied over a time-series array (2D array), and it is used for
creating the necessary augmented data used for LSTM networks, replicating the training
windows for each sample in the dataset. The difference between SlidingWindow and MovingWindow
is that here there is no intersection between two sequential batches</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>history_size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>int
The number of history samples to include in each window.</p>
            </div>
          </td>
        </tr>
        <tr>
          <td><code>skip_size</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>int
The number of samples to skip between each window.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Note:
    - The difference between SlidingWindow and MovingWindow is that here there is no intersection between two sequential batches.</p>
<p>See a graphical example:</p>
<p>Example:</p>
<pre><code>batch n
---------|---
history  | horizon

                batch n+1
                ---------|---
                    history  | horizon
</code></pre>
<p>Example:</p>
<pre><code>&gt;&gt;&gt; window = SlidingWindow(history_size=3, skip_size=1)
&gt;&gt;&gt; time_series = [1, 2, 3, 4, 5, 6, 7, 8, 9]
&gt;&gt;&gt; windows = window.apply(time_series)
&gt;&gt;&gt; windows
[[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6], [5, 6, 7], [6, 7, 8], [7, 8, 9]]
</code></pre>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1049</span>
<span class="normal">1050</span>
<span class="normal">1051</span>
<span class="normal">1052</span>
<span class="normal">1053</span>
<span class="normal">1054</span>
<span class="normal">1055</span>
<span class="normal">1056</span>
<span class="normal">1057</span>
<span class="normal">1058</span>
<span class="normal">1059</span>
<span class="normal">1060</span>
<span class="normal">1061</span>
<span class="normal">1062</span>
<span class="normal">1063</span>
<span class="normal">1064</span>
<span class="normal">1065</span>
<span class="normal">1066</span>
<span class="normal">1067</span>
<span class="normal">1068</span>
<span class="normal">1069</span>
<span class="normal">1070</span>
<span class="normal">1071</span>
<span class="normal">1072</span>
<span class="normal">1073</span>
<span class="normal">1074</span>
<span class="normal">1075</span>
<span class="normal">1076</span>
<span class="normal">1077</span>
<span class="normal">1078</span>
<span class="normal">1079</span>
<span class="normal">1080</span>
<span class="normal">1081</span>
<span class="normal">1082</span>
<span class="normal">1083</span>
<span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span>
<span class="normal">1101</span>
<span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span>
<span class="normal">1124</span>
<span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">SlidingWindow</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;SlidingWindow is applied over a time-series array (2D array), and it is used for</span>
<span class="sd">    creating the necessary augmented data used for LSTM networks, replicating the training</span>
<span class="sd">    windows for each sample in the dataset. The difference between SlidingWindow and MovingWindow</span>
<span class="sd">    is that here there is no intersection between two sequential batches</span>

<span class="sd">    Attributes:</span>
<span class="sd">        history_size : int</span>
<span class="sd">            The number of history samples to include in each window.</span>
<span class="sd">        skip_size : int</span>
<span class="sd">            The number of samples to skip between each window.</span>
<span class="sd">    Note:</span>
<span class="sd">        - The difference between SlidingWindow and MovingWindow is that here there is no intersection between two sequential batches.</span>

<span class="sd">    See a graphical example:</span>

<span class="sd">    Example:</span>

<span class="sd">        batch n</span>
<span class="sd">        ---------|---</span>
<span class="sd">        history  | horizon</span>

<span class="sd">                        batch n+1</span>
<span class="sd">                        ---------|---</span>
<span class="sd">                            history  | horizon</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; window = SlidingWindow(history_size=3, skip_size=1)</span>
<span class="sd">        &gt;&gt;&gt; time_series = [1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="sd">        &gt;&gt;&gt; windows = window.apply(time_series)</span>
<span class="sd">        &gt;&gt;&gt; windows</span>
<span class="sd">        [[1, 2, 3], [2, 3, 4], [3, 4, 5], [4, 5, 6], [5, 6, 7], [6, 7, 8], [7, 8, 9]]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">history_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">skip_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the SlidingWindow object.</span>

<span class="sd">        Args:</span>
<span class="sd">            history_size (int, optional): The number of history samples to include in each window. (Default value = None)</span>
<span class="sd">            skip_size (int, optional): The number of samples to skip between each window. (Default value = None)</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">=</span> <span class="n">history_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">=</span> <span class="n">skip_size</span>

        <span class="c1"># Verifying if history and horizon sizes was provided</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">history_size</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;A value for history_size must be provided, not </span><span class="si">{</span><span class="n">history_size</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">assert</span> <span class="n">skip_size</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;A value for horizon_size must be provided, not </span><span class="si">{</span><span class="n">skip_size</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Applies the sliding window to the given time series.</span>

<span class="sd">        Args:</span>
<span class="sd">            time_series (List[int]):</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[List[int]]:</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; window = SlidingWindow(history_size=3, skip_size=1)</span>
<span class="sd">            &gt;&gt;&gt; time_series = [1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="sd">            &gt;&gt;&gt; windows = window.apply(time_series)</span>
<span class="sd">            &gt;&gt;&gt; windows</span>
<span class="sd">            [[[1, 2, 3], [4, 5, 6]], [[4, 5, 6], [7, 8, 9]], [[7, 8, 9], [10, 11, 12]]]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">windowed_samples</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">window</span> <span class="o">=</span> <span class="n">time_series</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span><span class="p">]</span>
            <span class="n">windowed_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">windowed_samples</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Applies a sliding window operation on the given time series and returns the windowed samples.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data (np.ndarray, optional): 2D array (time-series) to be used for constructing the history size (Default value = None)</span>
<span class="sd">            output_data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Tuple[np.ndarray, np.ndarray]: tuple of np.ndarray with shapes (n_samples, n_history, n_features) and (n_samples, n_horizon, n_features)</span>

<span class="sd">        Note:</span>
<span class="sd">            - history_size and horizon_size should be positive integers</span>
<span class="sd">            - history_size should be less than the length of input_data</span>
<span class="sd">            - input_data and output_data should have the same number of rows</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = np.random.rand(10,3)</span>
<span class="sd">            &gt;&gt;&gt; history_size = 3</span>
<span class="sd">            &gt;&gt;&gt; horizon_size = 2</span>
<span class="sd">            &gt;&gt;&gt; window = Window(history_size, horizon_size)</span>
<span class="sd">            &gt;&gt;&gt; input_data, output_data = window(data)</span>
<span class="sd">            &gt;&gt;&gt; input_data.shape</span>
<span class="sd">            (4, 3, 3)</span>
<span class="sd">            &gt;&gt;&gt; output_data.shape</span>
<span class="sd">            (4, 2, 3)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="c1"># It is expected series_data to be a set of time-series with shape</span>
        <span class="c1"># (n_timesteps, n_variables)</span>

        <span class="n">input_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">output_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">data_size</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="k">assert</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">output_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

        <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span>

        <span class="c1"># Loop for covering the entire time-series dataset constructing the</span>
        <span class="c1"># training windows</span>
        <span class="k">while</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">&lt;=</span> <span class="n">data_size</span><span class="p">:</span>
            <span class="n">input_batch</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">center</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="p">:</span> <span class="n">center</span><span class="p">,</span> <span class="p">:]</span>
            <span class="n">output_batch</span> <span class="o">=</span> <span class="n">output_data</span><span class="p">[</span>
                <span class="n">center</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="p">:</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span><span class="p">,</span> <span class="p">:</span>
            <span class="p">]</span>

            <span class="n">input_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
            <span class="n">output_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_batch</span><span class="p">)</span>

            <span class="n">center</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span>

        <span class="n">input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">input_batches_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="n">output_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">output_batches_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">output_data</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.SlidingWindow.__call__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.SlidingWindow.__call__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies a sliding window operation on the given time series and returns the windowed samples.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>2D array (time-series) to be used for constructing the history size (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Tuple">Tuple</span>[<span title="numpy.ndarray">ndarray</span>, <span title="numpy.ndarray">ndarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Tuple[np.ndarray, np.ndarray]: tuple of np.ndarray with shapes (n_samples, n_history, n_features) and (n_samples, n_horizon, n_features)</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>history_size and horizon_size should be positive integers</li>
<li>history_size should be less than the length of input_data</li>
<li>input_data and output_data should have the same number of rows</li>
</ul>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; data = np.random.rand(10,3)
&gt;&gt;&gt; history_size = 3
&gt;&gt;&gt; horizon_size = 2
&gt;&gt;&gt; window = Window(history_size, horizon_size)
&gt;&gt;&gt; input_data, output_data = window(data)
&gt;&gt;&gt; input_data.shape
(4, 3, 3)
&gt;&gt;&gt; output_data.shape
(4, 2, 3)
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1125</span>
<span class="normal">1126</span>
<span class="normal">1127</span>
<span class="normal">1128</span>
<span class="normal">1129</span>
<span class="normal">1130</span>
<span class="normal">1131</span>
<span class="normal">1132</span>
<span class="normal">1133</span>
<span class="normal">1134</span>
<span class="normal">1135</span>
<span class="normal">1136</span>
<span class="normal">1137</span>
<span class="normal">1138</span>
<span class="normal">1139</span>
<span class="normal">1140</span>
<span class="normal">1141</span>
<span class="normal">1142</span>
<span class="normal">1143</span>
<span class="normal">1144</span>
<span class="normal">1145</span>
<span class="normal">1146</span>
<span class="normal">1147</span>
<span class="normal">1148</span>
<span class="normal">1149</span>
<span class="normal">1150</span>
<span class="normal">1151</span>
<span class="normal">1152</span>
<span class="normal">1153</span>
<span class="normal">1154</span>
<span class="normal">1155</span>
<span class="normal">1156</span>
<span class="normal">1157</span>
<span class="normal">1158</span>
<span class="normal">1159</span>
<span class="normal">1160</span>
<span class="normal">1161</span>
<span class="normal">1162</span>
<span class="normal">1163</span>
<span class="normal">1164</span>
<span class="normal">1165</span>
<span class="normal">1166</span>
<span class="normal">1167</span>
<span class="normal">1168</span>
<span class="normal">1169</span>
<span class="normal">1170</span>
<span class="normal">1171</span>
<span class="normal">1172</span>
<span class="normal">1173</span>
<span class="normal">1174</span>
<span class="normal">1175</span>
<span class="normal">1176</span>
<span class="normal">1177</span>
<span class="normal">1178</span>
<span class="normal">1179</span>
<span class="normal">1180</span>
<span class="normal">1181</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">output_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Tuple</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Applies a sliding window operation on the given time series and returns the windowed samples.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_data (np.ndarray, optional): 2D array (time-series) to be used for constructing the history size (Default value = None)</span>
<span class="sd">        output_data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Tuple[np.ndarray, np.ndarray]: tuple of np.ndarray with shapes (n_samples, n_history, n_features) and (n_samples, n_horizon, n_features)</span>

<span class="sd">    Note:</span>
<span class="sd">        - history_size and horizon_size should be positive integers</span>
<span class="sd">        - history_size should be less than the length of input_data</span>
<span class="sd">        - input_data and output_data should have the same number of rows</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = np.random.rand(10,3)</span>
<span class="sd">        &gt;&gt;&gt; history_size = 3</span>
<span class="sd">        &gt;&gt;&gt; horizon_size = 2</span>
<span class="sd">        &gt;&gt;&gt; window = Window(history_size, horizon_size)</span>
<span class="sd">        &gt;&gt;&gt; input_data, output_data = window(data)</span>
<span class="sd">        &gt;&gt;&gt; input_data.shape</span>
<span class="sd">        (4, 3, 3)</span>
<span class="sd">        &gt;&gt;&gt; output_data.shape</span>
<span class="sd">        (4, 2, 3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># It is expected series_data to be a set of time-series with shape</span>
    <span class="c1"># (n_timesteps, n_variables)</span>

    <span class="n">input_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">output_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">data_size</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="k">assert</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="n">output_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="n">center</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span>

    <span class="c1"># Loop for covering the entire time-series dataset constructing the</span>
    <span class="c1"># training windows</span>
    <span class="k">while</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">&lt;=</span> <span class="n">data_size</span><span class="p">:</span>
        <span class="n">input_batch</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">center</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="p">:</span> <span class="n">center</span><span class="p">,</span> <span class="p">:]</span>
        <span class="n">output_batch</span> <span class="o">=</span> <span class="n">output_data</span><span class="p">[</span>
            <span class="n">center</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="p">:</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span><span class="p">,</span> <span class="p">:</span>
        <span class="p">]</span>

        <span class="n">input_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>
        <span class="n">output_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">output_batch</span><span class="p">)</span>

        <span class="n">center</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span>

    <span class="n">input_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">input_batches_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
    <span class="n">output_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span><span class="n">output_batches_list</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">input_data</span><span class="p">,</span> <span class="n">output_data</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.SlidingWindow.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">history_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">skip_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.SlidingWindow.__init__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Initialize the SlidingWindow object.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>history_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of history samples to include in each window. (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>skip_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The number of samples to skip between each window. (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1084</span>
<span class="normal">1085</span>
<span class="normal">1086</span>
<span class="normal">1087</span>
<span class="normal">1088</span>
<span class="normal">1089</span>
<span class="normal">1090</span>
<span class="normal">1091</span>
<span class="normal">1092</span>
<span class="normal">1093</span>
<span class="normal">1094</span>
<span class="normal">1095</span>
<span class="normal">1096</span>
<span class="normal">1097</span>
<span class="normal">1098</span>
<span class="normal">1099</span>
<span class="normal">1100</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">history_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">skip_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initialize the SlidingWindow object.</span>

<span class="sd">    Args:</span>
<span class="sd">        history_size (int, optional): The number of history samples to include in each window. (Default value = None)</span>
<span class="sd">        skip_size (int, optional): The number of samples to skip between each window. (Default value = None)</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">=</span> <span class="n">history_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">=</span> <span class="n">skip_size</span>

    <span class="c1"># Verifying if history and horizon sizes was provided</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">history_size</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;A value for history_size must be provided, not </span><span class="si">{</span><span class="n">history_size</span><span class="si">}</span><span class="s2">&quot;</span>
    <span class="k">assert</span> <span class="n">skip_size</span><span class="p">,</span> <span class="sa">f</span><span class="s2">&quot;A value for horizon_size must be provided, not </span><span class="si">{</span><span class="n">skip_size</span><span class="si">}</span><span class="s2">&quot;</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.SlidingWindow.apply" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">apply</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span></code>

<a href="#simulai.io.SlidingWindow.apply" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the sliding window to the given time series.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_series</code></td>
          <td>
                <code><span title="typing.List">List</span>[int]</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
          <td>
              <em>required</em>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<span title="typing.List">List</span>[int]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>List[List[int]]:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Example:</p>
<pre><code>&gt;&gt;&gt; window = SlidingWindow(history_size=3, skip_size=1)
&gt;&gt;&gt; time_series = [1, 2, 3, 4, 5, 6, 7, 8, 9]
&gt;&gt;&gt; windows = window.apply(time_series)
&gt;&gt;&gt; windows
[[[1, 2, 3], [4, 5, 6]], [[4, 5, 6], [7, 8, 9]], [[7, 8, 9], [10, 11, 12]]]
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1102</span>
<span class="normal">1103</span>
<span class="normal">1104</span>
<span class="normal">1105</span>
<span class="normal">1106</span>
<span class="normal">1107</span>
<span class="normal">1108</span>
<span class="normal">1109</span>
<span class="normal">1110</span>
<span class="normal">1111</span>
<span class="normal">1112</span>
<span class="normal">1113</span>
<span class="normal">1114</span>
<span class="normal">1115</span>
<span class="normal">1116</span>
<span class="normal">1117</span>
<span class="normal">1118</span>
<span class="normal">1119</span>
<span class="normal">1120</span>
<span class="normal">1121</span>
<span class="normal">1122</span>
<span class="normal">1123</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">apply</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">time_series</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">])</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">List</span><span class="p">[</span><span class="nb">int</span><span class="p">]]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Applies the sliding window to the given time series.</span>

<span class="sd">    Args:</span>
<span class="sd">        time_series (List[int]):</span>

<span class="sd">    Returns:</span>
<span class="sd">        List[List[int]]:</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; window = SlidingWindow(history_size=3, skip_size=1)</span>
<span class="sd">        &gt;&gt;&gt; time_series = [1, 2, 3, 4, 5, 6, 7, 8, 9]</span>
<span class="sd">        &gt;&gt;&gt; windows = window.apply(time_series)</span>
<span class="sd">        &gt;&gt;&gt; windows</span>
<span class="sd">        [[[1, 2, 3], [4, 5, 6]], [[4, 5, 6], [7, 8, 9]], [[7, 8, 9], [10, 11, 12]]]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">windowed_samples</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">time_series</span><span class="p">)</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
        <span class="n">window</span> <span class="o">=</span> <span class="n">time_series</span><span class="p">[</span><span class="n">i</span> <span class="p">:</span> <span class="n">i</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">history_size</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span><span class="p">]</span>
        <span class="n">windowed_samples</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">window</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">windowed_samples</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="intersectingbatches"><red>IntersectingBatches</red><a class="headerlink" href="#intersectingbatches" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.IntersectingBatches"></a>
  <div class="doc doc-contents first">

  
      <p>IntersectingBatches is a class that is applied over a time-series array (2D array) to create batches of input data for training or testing purposes.</p>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1184</span>
<span class="normal">1185</span>
<span class="normal">1186</span>
<span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span>
<span class="normal">1205</span>
<span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span>
<span class="normal">1231</span>
<span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">IntersectingBatches</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;IntersectingBatches is a class that is applied over a time-series array (2D array) to create batches of input data for training or testing purposes.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">skip_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initializes the IntersectingBatches class</span>

<span class="sd">        Args:</span>
<span class="sd">            skip_size (int, optional): Number of samples to skip between two windows. (Default value = 1)</span>
<span class="sd">            batch_size (int, optional): Number of samples to use in each batch. (Default value = None)</span>
<span class="sd">            full (bool, optional): Whether to include the last batch or not, even if it&#39;s not full. (Default value = True)</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="n">batch_size</span>
        <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;A value for horizon_size must be provided, not </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">&quot;</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">=</span> <span class="n">skip_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">full</span> <span class="o">=</span> <span class="n">full</span>

    <span class="k">def</span> <span class="nf">get_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;It gets just the indices of the shifting</span>

<span class="sd">        Args:</span>
<span class="sd">            dim (int, optional): total dimension (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: the shifted indices</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">center</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">indices_m</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

        <span class="c1"># Loop for covering the entire time-series dataset constructing the</span>
        <span class="c1"># training windows</span>
        <span class="k">while</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">&lt;</span> <span class="n">dim</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span>

            <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
            <span class="n">indices_m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

            <span class="n">center</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices_m</span><span class="p">)</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Applies the batching strategy to the input data.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[list, np.ndarray]: A list of batches or a single batch if `full` attribute is set to False.</span>
<span class="sd">        Note:</span>
<span class="sd">            - If the `full` attribute is set to True, the last batch will be included even if it&#39;s not full.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; input_data = np.array([[1,2,3], [4,5,6], [7,8,9], [10,11,12]])</span>
<span class="sd">            &gt;&gt;&gt; batches = IntersectingBatches(skip_size=1, batch_size=2)</span>
<span class="sd">            &gt;&gt;&gt; batches(input_data)</span>
<span class="sd">            [array([[1, 2, 3],</span>
<span class="sd">                [4, 5, 6]]),</span>
<span class="sd">            array([[4, 5, 6],</span>
<span class="sd">                [7, 8, 9]]),</span>
<span class="sd">            array([[ 7,  8,  9],</span>
<span class="sd">                [10, 11, 12]])]</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">input_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">data_size</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">center</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="c1"># Loop for covering the entire time-series dataset constructing the</span>
        <span class="c1"># training windows</span>
        <span class="k">while</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">&lt;=</span> <span class="n">data_size</span><span class="p">:</span>
            <span class="n">input_batch</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">center</span> <span class="p">:</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">]</span>

            <span class="n">input_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

            <span class="n">center</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span>

        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">full</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">input_batches_list</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">input_batches_list</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.IntersectingBatches.__call__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.IntersectingBatches.__call__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Applies the batching strategy to the input data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_data</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.Union">Union</span>[list, <span title="numpy.ndarray">ndarray</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Union[list, np.ndarray]: A list of batches or a single batch if <code>full</code> attribute is set to False.</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Note:
    - If the <code>full</code> attribute is set to True, the last batch will be included even if it's not full.
Example:</p>
<pre><code>&gt;&gt;&gt; input_data = np.array([[1,2,3], [4,5,6], [7,8,9], [10,11,12]])
&gt;&gt;&gt; batches = IntersectingBatches(skip_size=1, batch_size=2)
&gt;&gt;&gt; batches(input_data)
[array([[1, 2, 3],
    [4, 5, 6]]),
array([[4, 5, 6],
    [7, 8, 9]]),
array([[ 7,  8,  9],
    [10, 11, 12]])]
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1232</span>
<span class="normal">1233</span>
<span class="normal">1234</span>
<span class="normal">1235</span>
<span class="normal">1236</span>
<span class="normal">1237</span>
<span class="normal">1238</span>
<span class="normal">1239</span>
<span class="normal">1240</span>
<span class="normal">1241</span>
<span class="normal">1242</span>
<span class="normal">1243</span>
<span class="normal">1244</span>
<span class="normal">1245</span>
<span class="normal">1246</span>
<span class="normal">1247</span>
<span class="normal">1248</span>
<span class="normal">1249</span>
<span class="normal">1250</span>
<span class="normal">1251</span>
<span class="normal">1252</span>
<span class="normal">1253</span>
<span class="normal">1254</span>
<span class="normal">1255</span>
<span class="normal">1256</span>
<span class="normal">1257</span>
<span class="normal">1258</span>
<span class="normal">1259</span>
<span class="normal">1260</span>
<span class="normal">1261</span>
<span class="normal">1262</span>
<span class="normal">1263</span>
<span class="normal">1264</span>
<span class="normal">1265</span>
<span class="normal">1266</span>
<span class="normal">1267</span>
<span class="normal">1268</span>
<span class="normal">1269</span>
<span class="normal">1270</span>
<span class="normal">1271</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Applies the batching strategy to the input data.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_data (np.ndarray, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[list, np.ndarray]: A list of batches or a single batch if `full` attribute is set to False.</span>
<span class="sd">    Note:</span>
<span class="sd">        - If the `full` attribute is set to True, the last batch will be included even if it&#39;s not full.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; input_data = np.array([[1,2,3], [4,5,6], [7,8,9], [10,11,12]])</span>
<span class="sd">        &gt;&gt;&gt; batches = IntersectingBatches(skip_size=1, batch_size=2)</span>
<span class="sd">        &gt;&gt;&gt; batches(input_data)</span>
<span class="sd">        [array([[1, 2, 3],</span>
<span class="sd">            [4, 5, 6]]),</span>
<span class="sd">        array([[4, 5, 6],</span>
<span class="sd">            [7, 8, 9]]),</span>
<span class="sd">        array([[ 7,  8,  9],</span>
<span class="sd">            [10, 11, 12]])]</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">input_batches_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">data_size</span> <span class="o">=</span> <span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">center</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Loop for covering the entire time-series dataset constructing the</span>
    <span class="c1"># training windows</span>
    <span class="k">while</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">&lt;=</span> <span class="n">data_size</span><span class="p">:</span>
        <span class="n">input_batch</span> <span class="o">=</span> <span class="n">input_data</span><span class="p">[</span><span class="n">center</span> <span class="p">:</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span><span class="p">]</span>

        <span class="n">input_batches_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">input_batch</span><span class="p">)</span>

        <span class="n">center</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span>

    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">full</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">input_batches_list</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">([</span><span class="n">item</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">input_batches_list</span><span class="p">])</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.IntersectingBatches.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">skip_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></code>

<a href="#simulai.io.IntersectingBatches.__init__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Initializes the IntersectingBatches class</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>skip_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of samples to skip between two windows. (Default value = 1)</p>
            </div>
          </td>
          <td>
                <code>1</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Number of samples to use in each batch. (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>full</code></td>
          <td>
                <code>bool</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Whether to include the last batch or not, even if it's not full. (Default value = True)</p>
            </div>
          </td>
          <td>
                <code>True</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1187</span>
<span class="normal">1188</span>
<span class="normal">1189</span>
<span class="normal">1190</span>
<span class="normal">1191</span>
<span class="normal">1192</span>
<span class="normal">1193</span>
<span class="normal">1194</span>
<span class="normal">1195</span>
<span class="normal">1196</span>
<span class="normal">1197</span>
<span class="normal">1198</span>
<span class="normal">1199</span>
<span class="normal">1200</span>
<span class="normal">1201</span>
<span class="normal">1202</span>
<span class="normal">1203</span>
<span class="normal">1204</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span> <span class="n">skip_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">full</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">True</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Initializes the IntersectingBatches class</span>

<span class="sd">    Args:</span>
<span class="sd">        skip_size (int, optional): Number of samples to skip between two windows. (Default value = 1)</span>
<span class="sd">        batch_size (int, optional): Number of samples to use in each batch. (Default value = None)</span>
<span class="sd">        full (bool, optional): Whether to include the last batch or not, even if it&#39;s not full. (Default value = True)</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">assert</span> <span class="p">(</span>
        <span class="n">batch_size</span>
    <span class="p">),</span> <span class="sa">f</span><span class="s2">&quot;A value for horizon_size must be provided, not </span><span class="si">{</span><span class="n">batch_size</span><span class="si">}</span><span class="s2">&quot;</span>

    <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span> <span class="o">=</span> <span class="n">skip_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">full</span> <span class="o">=</span> <span class="n">full</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.IntersectingBatches.get_indices" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">get_indices</span><span class="p">(</span><span class="n">dim</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.IntersectingBatches.get_indices" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>It gets just the indices of the shifting</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>dim</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>total dimension (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray: the shifted indices</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1206</span>
<span class="normal">1207</span>
<span class="normal">1208</span>
<span class="normal">1209</span>
<span class="normal">1210</span>
<span class="normal">1211</span>
<span class="normal">1212</span>
<span class="normal">1213</span>
<span class="normal">1214</span>
<span class="normal">1215</span>
<span class="normal">1216</span>
<span class="normal">1217</span>
<span class="normal">1218</span>
<span class="normal">1219</span>
<span class="normal">1220</span>
<span class="normal">1221</span>
<span class="normal">1222</span>
<span class="normal">1223</span>
<span class="normal">1224</span>
<span class="normal">1225</span>
<span class="normal">1226</span>
<span class="normal">1227</span>
<span class="normal">1228</span>
<span class="normal">1229</span>
<span class="normal">1230</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">get_indices</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dim</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;It gets just the indices of the shifting</span>

<span class="sd">    Args:</span>
<span class="sd">        dim (int, optional): total dimension (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray: the shifted indices</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">center</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="n">indices</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
    <span class="n">indices_m</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>

    <span class="c1"># Loop for covering the entire time-series dataset constructing the</span>
    <span class="c1"># training windows</span>
    <span class="k">while</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">&lt;</span> <span class="n">dim</span><span class="p">:</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">center</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span>

        <span class="n">indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">center</span><span class="p">)</span>
        <span class="n">indices_m</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>

        <span class="n">center</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">skip_size</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">indices_m</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="batchwiseextrapolation"><red>BatchwiseExtrapolation</red><a class="headerlink" href="#batchwiseextrapolation" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.BatchwiseExtrapolation"></a>
  <div class="doc doc-contents first">

  
      <p>BatchwiseExtraplation uses a time-series regression model and inputs as generated by
MovingWindow to continuously extrapolate a dataset.</p>



  <p><strong>Attributes:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>time_id</code></td>
          <td>
          </td>
          <td>
            <div class="doc-md-description">
              <p>int</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Examples::</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; from sklearn.linear_model import LinearRegression
&gt;&gt;&gt; model = LinearRegression()
&gt;&gt;&gt; op = lambda state: model.predict(state)
&gt;&gt;&gt; auxiliary_data = np.random.rand(100, 10)
&gt;&gt;&gt; batchwise_extrapolation = BatchwiseExtrapolation(op=op, auxiliary_data=auxiliary_data)
&gt;&gt;&gt; init_state = np.random.rand(1, 10, 20)
&gt;&gt;&gt; history_size = 3
&gt;&gt;&gt; horizon_size = 2
&gt;&gt;&gt; testing_data_size = 10
&gt;&gt;&gt; extrapolation_dataset = batchwise_extrapolation(init_state, history_size, horizon_size, testing_data_size)
&gt;&gt;&gt; extrapolation_dataset.shape
</code></pre>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1274</span>
<span class="normal">1275</span>
<span class="normal">1276</span>
<span class="normal">1277</span>
<span class="normal">1278</span>
<span class="normal">1279</span>
<span class="normal">1280</span>
<span class="normal">1281</span>
<span class="normal">1282</span>
<span class="normal">1283</span>
<span class="normal">1284</span>
<span class="normal">1285</span>
<span class="normal">1286</span>
<span class="normal">1287</span>
<span class="normal">1288</span>
<span class="normal">1289</span>
<span class="normal">1290</span>
<span class="normal">1291</span>
<span class="normal">1292</span>
<span class="normal">1293</span>
<span class="normal">1294</span>
<span class="normal">1295</span>
<span class="normal">1296</span>
<span class="normal">1297</span>
<span class="normal">1298</span>
<span class="normal">1299</span>
<span class="normal">1300</span>
<span class="normal">1301</span>
<span class="normal">1302</span>
<span class="normal">1303</span>
<span class="normal">1304</span>
<span class="normal">1305</span>
<span class="normal">1306</span>
<span class="normal">1307</span>
<span class="normal">1308</span>
<span class="normal">1309</span>
<span class="normal">1310</span>
<span class="normal">1311</span>
<span class="normal">1312</span>
<span class="normal">1313</span>
<span class="normal">1314</span>
<span class="normal">1315</span>
<span class="normal">1316</span>
<span class="normal">1317</span>
<span class="normal">1318</span>
<span class="normal">1319</span>
<span class="normal">1320</span>
<span class="normal">1321</span>
<span class="normal">1322</span>
<span class="normal">1323</span>
<span class="normal">1324</span>
<span class="normal">1325</span>
<span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BatchwiseExtrapolation</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;BatchwiseExtraplation uses a time-series regression model and inputs as generated by</span>
<span class="sd">    MovingWindow to continuously extrapolate a dataset.</span>

<span class="sd">    Attributes:</span>
<span class="sd">        time_id : int</span>
<span class="sd">    Examples::</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from sklearn.linear_model import LinearRegression</span>
<span class="sd">        &gt;&gt;&gt; model = LinearRegression()</span>
<span class="sd">        &gt;&gt;&gt; op = lambda state: model.predict(state)</span>
<span class="sd">        &gt;&gt;&gt; auxiliary_data = np.random.rand(100, 10)</span>
<span class="sd">        &gt;&gt;&gt; batchwise_extrapolation = BatchwiseExtrapolation(op=op, auxiliary_data=auxiliary_data)</span>
<span class="sd">        &gt;&gt;&gt; init_state = np.random.rand(1, 10, 20)</span>
<span class="sd">        &gt;&gt;&gt; history_size = 3</span>
<span class="sd">        &gt;&gt;&gt; horizon_size = 2</span>
<span class="sd">        &gt;&gt;&gt; testing_data_size = 10</span>
<span class="sd">        &gt;&gt;&gt; extrapolation_dataset = batchwise_extrapolation(init_state, history_size, horizon_size, testing_data_size)</span>
<span class="sd">        &gt;&gt;&gt; extrapolation_dataset.shape</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">op</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">auxiliary_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">op</span> <span class="o">=</span> <span class="n">op</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span> <span class="o">=</span> <span class="n">auxiliary_data</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_id</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="k">def</span> <span class="nf">_simple_extrapolation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">extrapolation_dataset</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">history_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Given the current extrapolation dataset, use the last history_size number of rows to create the next state of the dataset.</span>

<span class="sd">        Args:</span>
<span class="sd">            extrapolation_dataset (np.ndarray): The current state of the extrapolation dataset.</span>
<span class="sd">            history_size (int, optional):  (Default value = 0)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray: The next state of the extrapolation dataset.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">extrapolation_dataset</span><span class="p">[</span><span class="kc">None</span><span class="p">,</span> <span class="o">-</span><span class="n">history_size</span><span class="p">:,</span> <span class="p">:]</span>

    <span class="k">def</span> <span class="nf">_forcing_extrapolation</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">extrapolation_dataset</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">history_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">(</span>
            <span class="p">[</span>
                <span class="n">extrapolation_dataset</span><span class="p">[</span><span class="o">-</span><span class="n">history_size</span><span class="p">:,</span> <span class="p">:],</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">time_id</span> <span class="o">-</span> <span class="n">history_size</span> <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">time_id</span><span class="p">,</span> <span class="p">:],</span>
            <span class="p">]</span>
        <span class="p">)[</span><span class="kc">None</span><span class="p">,</span> <span class="p">:,</span> <span class="p">:]</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">init_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">history_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">horizon_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">testing_data_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A function that performs the extrapolation of the time series.</span>

<span class="sd">        Args:</span>
<span class="sd">            init_state (np.ndarray, optional): initial state of the time series. It should have the shape (batch_size, history_size, n_series) (Default value = None)</span>
<span class="sd">            history_size (int, optional): the size of the history window used in the extrapolation. (Default value = None)</span>
<span class="sd">            horizon_size (int, optional): the size of the horizon window used in the extrapolation. (Default value = None)</span>
<span class="sd">            testing_data_size (int, optional):  (Default value = None)</span>

<span class="sd">        Returns:</span>
<span class="sd">            np.ndarray:</span>

<span class="sd">        Note:</span>
<span class="sd">            The number of series in the initial state must be equal to the number of series in the auxiliary data, if it is provided.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; model = BatchwiseExtrapolation()</span>
<span class="sd">            #Init state of the time series</span>
<span class="sd">            &gt;&gt;&gt; init_state = np.random.random((1,20,3))</span>
<span class="sd">            &gt;&gt;&gt; history_size = 10</span>
<span class="sd">            &gt;&gt;&gt; horizon_size = 5</span>
<span class="sd">            &gt;&gt;&gt; testing_data_size = 50</span>
<span class="sd">            #Calling the function</span>
<span class="sd">            &gt;&gt;&gt; output = model(init_state, history_size, horizon_size, testing_data_size)</span>
<span class="sd">            &gt;&gt;&gt; print(output.shape)</span>
<span class="sd">            #(50,3)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">n_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">n_series</span> <span class="o">=</span> <span class="mi">0</span>

        <span class="n">current_state</span> <span class="o">=</span> <span class="n">init_state</span>
        <span class="n">extrapolation_dataset</span> <span class="o">=</span> <span class="n">init_state</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">n_series</span><span class="p">:]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">time_id</span> <span class="o">=</span> <span class="n">history_size</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">assert</span> <span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">n_series</span> <span class="o">==</span> <span class="n">init_state</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">),</span> <span class="s2">&quot;Number of series in the initial state must be </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="p">)</span>

            <span class="n">current_state_constructor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forcing_extrapolation</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">current_state_constructor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simple_extrapolation</span>

        <span class="k">while</span> <span class="p">(</span>
            <span class="n">extrapolation_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">history_size</span> <span class="o">+</span> <span class="n">horizon_size</span>
            <span class="o">&lt;=</span> <span class="n">testing_data_size</span>
        <span class="p">):</span>
            <span class="n">extrapolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">current_state</span><span class="p">)</span>
            <span class="n">extrapolation_dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
                <span class="p">[</span><span class="n">extrapolation_dataset</span><span class="p">,</span> <span class="n">extrapolation</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="mi">0</span>
            <span class="p">)</span>
            <span class="n">current_state</span> <span class="o">=</span> <span class="n">current_state_constructor</span><span class="p">(</span>
                <span class="n">extrapolation_dataset</span><span class="p">,</span> <span class="n">history_size</span><span class="o">=</span><span class="n">history_size</span>
            <span class="p">)</span>

            <span class="n">log_str</span> <span class="o">=</span> <span class="s2">&quot;Extrapolation </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_id</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">history_size</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">log_str</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

            <span class="bp">self</span><span class="o">.</span><span class="n">time_id</span> <span class="o">+=</span> <span class="n">horizon_size</span>

        <span class="n">extrapolation_dataset</span> <span class="o">=</span> <span class="n">extrapolation_dataset</span><span class="p">[</span><span class="n">history_size</span><span class="p">:,</span> <span class="p">:]</span>

        <span class="k">return</span> <span class="n">extrapolation_dataset</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.BatchwiseExtrapolation.__call__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">init_state</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">history_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">horizon_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">testing_data_size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></code>

<a href="#simulai.io.BatchwiseExtrapolation.__call__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>A function that performs the extrapolation of the time series.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>init_state</code></td>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>initial state of the time series. It should have the shape (batch_size, history_size, n_series) (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>history_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the history window used in the extrapolation. (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>horizon_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the horizon window used in the extrapolation. (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>testing_data_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="numpy.ndarray">ndarray</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>np.ndarray:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <p>The number of series in the initial state must be equal to the number of series in the auxiliary data, if it is provided.</p>
</details>      <p>Example:</p>
<pre><code>&gt;&gt;&gt; model = BatchwiseExtrapolation()
#Init state of the time series
&gt;&gt;&gt; init_state = np.random.random((1,20,3))
&gt;&gt;&gt; history_size = 10
&gt;&gt;&gt; horizon_size = 5
&gt;&gt;&gt; testing_data_size = 50
#Calling the function
&gt;&gt;&gt; output = model(init_state, history_size, horizon_size, testing_data_size)
&gt;&gt;&gt; print(output.shape)
#(50,3)
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1326</span>
<span class="normal">1327</span>
<span class="normal">1328</span>
<span class="normal">1329</span>
<span class="normal">1330</span>
<span class="normal">1331</span>
<span class="normal">1332</span>
<span class="normal">1333</span>
<span class="normal">1334</span>
<span class="normal">1335</span>
<span class="normal">1336</span>
<span class="normal">1337</span>
<span class="normal">1338</span>
<span class="normal">1339</span>
<span class="normal">1340</span>
<span class="normal">1341</span>
<span class="normal">1342</span>
<span class="normal">1343</span>
<span class="normal">1344</span>
<span class="normal">1345</span>
<span class="normal">1346</span>
<span class="normal">1347</span>
<span class="normal">1348</span>
<span class="normal">1349</span>
<span class="normal">1350</span>
<span class="normal">1351</span>
<span class="normal">1352</span>
<span class="normal">1353</span>
<span class="normal">1354</span>
<span class="normal">1355</span>
<span class="normal">1356</span>
<span class="normal">1357</span>
<span class="normal">1358</span>
<span class="normal">1359</span>
<span class="normal">1360</span>
<span class="normal">1361</span>
<span class="normal">1362</span>
<span class="normal">1363</span>
<span class="normal">1364</span>
<span class="normal">1365</span>
<span class="normal">1366</span>
<span class="normal">1367</span>
<span class="normal">1368</span>
<span class="normal">1369</span>
<span class="normal">1370</span>
<span class="normal">1371</span>
<span class="normal">1372</span>
<span class="normal">1373</span>
<span class="normal">1374</span>
<span class="normal">1375</span>
<span class="normal">1376</span>
<span class="normal">1377</span>
<span class="normal">1378</span>
<span class="normal">1379</span>
<span class="normal">1380</span>
<span class="normal">1381</span>
<span class="normal">1382</span>
<span class="normal">1383</span>
<span class="normal">1384</span>
<span class="normal">1385</span>
<span class="normal">1386</span>
<span class="normal">1387</span>
<span class="normal">1388</span>
<span class="normal">1389</span>
<span class="normal">1390</span>
<span class="normal">1391</span>
<span class="normal">1392</span>
<span class="normal">1393</span>
<span class="normal">1394</span>
<span class="normal">1395</span>
<span class="normal">1396</span>
<span class="normal">1397</span>
<span class="normal">1398</span>
<span class="normal">1399</span>
<span class="normal">1400</span>
<span class="normal">1401</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">init_state</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">history_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">horizon_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">testing_data_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A function that performs the extrapolation of the time series.</span>

<span class="sd">    Args:</span>
<span class="sd">        init_state (np.ndarray, optional): initial state of the time series. It should have the shape (batch_size, history_size, n_series) (Default value = None)</span>
<span class="sd">        history_size (int, optional): the size of the history window used in the extrapolation. (Default value = None)</span>
<span class="sd">        horizon_size (int, optional): the size of the horizon window used in the extrapolation. (Default value = None)</span>
<span class="sd">        testing_data_size (int, optional):  (Default value = None)</span>

<span class="sd">    Returns:</span>
<span class="sd">        np.ndarray:</span>

<span class="sd">    Note:</span>
<span class="sd">        The number of series in the initial state must be equal to the number of series in the auxiliary data, if it is provided.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; model = BatchwiseExtrapolation()</span>
<span class="sd">        #Init state of the time series</span>
<span class="sd">        &gt;&gt;&gt; init_state = np.random.random((1,20,3))</span>
<span class="sd">        &gt;&gt;&gt; history_size = 10</span>
<span class="sd">        &gt;&gt;&gt; horizon_size = 5</span>
<span class="sd">        &gt;&gt;&gt; testing_data_size = 50</span>
<span class="sd">        #Calling the function</span>
<span class="sd">        &gt;&gt;&gt; output = model(init_state, history_size, horizon_size, testing_data_size)</span>
<span class="sd">        &gt;&gt;&gt; print(output.shape)</span>
<span class="sd">        #(50,3)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="n">n_series</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">n_series</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="n">current_state</span> <span class="o">=</span> <span class="n">init_state</span>
    <span class="n">extrapolation_dataset</span> <span class="o">=</span> <span class="n">init_state</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="n">n_series</span><span class="p">:]</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">time_id</span> <span class="o">=</span> <span class="n">history_size</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">assert</span> <span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">n_series</span> <span class="o">==</span> <span class="n">init_state</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">),</span> <span class="s2">&quot;Number of series in the initial state must be </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">auxiliary_data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="p">)</span>

        <span class="n">current_state_constructor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_forcing_extrapolation</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="n">current_state_constructor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_simple_extrapolation</span>

    <span class="k">while</span> <span class="p">(</span>
        <span class="n">extrapolation_dataset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">history_size</span> <span class="o">+</span> <span class="n">horizon_size</span>
        <span class="o">&lt;=</span> <span class="n">testing_data_size</span>
    <span class="p">):</span>
        <span class="n">extrapolation</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">op</span><span class="p">(</span><span class="n">current_state</span><span class="p">)</span>
        <span class="n">extrapolation_dataset</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">(</span>
            <span class="p">[</span><span class="n">extrapolation_dataset</span><span class="p">,</span> <span class="n">extrapolation</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="mi">0</span>
        <span class="p">)</span>
        <span class="n">current_state</span> <span class="o">=</span> <span class="n">current_state_constructor</span><span class="p">(</span>
            <span class="n">extrapolation_dataset</span><span class="p">,</span> <span class="n">history_size</span><span class="o">=</span><span class="n">history_size</span>
        <span class="p">)</span>

        <span class="n">log_str</span> <span class="o">=</span> <span class="s2">&quot;Extrapolation </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">time_id</span> <span class="o">+</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">history_size</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\r</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="n">log_str</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">stdout</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">time_id</span> <span class="o">+=</span> <span class="n">horizon_size</span>

    <span class="n">extrapolation_dataset</span> <span class="o">=</span> <span class="n">extrapolation_dataset</span><span class="p">[</span><span class="n">history_size</span><span class="p">:,</span> <span class="p">:]</span>

    <span class="k">return</span> <span class="n">extrapolation_dataset</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="batchcopy"><red>BatchCopy</red><a class="headerlink" href="#batchcopy" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.BatchCopy"></a>
  <div class="doc doc-contents first">

  
      <p>A class for copying data in batches and applying a transformation function.</p>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1407</span>
<span class="normal">1408</span>
<span class="normal">1409</span>
<span class="normal">1410</span>
<span class="normal">1411</span>
<span class="normal">1412</span>
<span class="normal">1413</span>
<span class="normal">1414</span>
<span class="normal">1415</span>
<span class="normal">1416</span>
<span class="normal">1417</span>
<span class="normal">1418</span>
<span class="normal">1419</span>
<span class="normal">1420</span>
<span class="normal">1421</span>
<span class="normal">1422</span>
<span class="normal">1423</span>
<span class="normal">1424</span>
<span class="normal">1425</span>
<span class="normal">1426</span>
<span class="normal">1427</span>
<span class="normal">1428</span>
<span class="normal">1429</span>
<span class="normal">1430</span>
<span class="normal">1431</span>
<span class="normal">1432</span>
<span class="normal">1433</span>
<span class="normal">1434</span>
<span class="normal">1435</span>
<span class="normal">1436</span>
<span class="normal">1437</span>
<span class="normal">1438</span>
<span class="normal">1439</span>
<span class="normal">1440</span>
<span class="normal">1441</span>
<span class="normal">1442</span>
<span class="normal">1443</span>
<span class="normal">1444</span>
<span class="normal">1445</span>
<span class="normal">1446</span>
<span class="normal">1447</span>
<span class="normal">1448</span>
<span class="normal">1449</span>
<span class="normal">1450</span>
<span class="normal">1451</span>
<span class="normal">1452</span>
<span class="normal">1453</span>
<span class="normal">1454</span>
<span class="normal">1455</span>
<span class="normal">1456</span>
<span class="normal">1457</span>
<span class="normal">1458</span>
<span class="normal">1459</span>
<span class="normal">1460</span>
<span class="normal">1461</span>
<span class="normal">1462</span>
<span class="normal">1463</span>
<span class="normal">1464</span>
<span class="normal">1465</span>
<span class="normal">1466</span>
<span class="normal">1467</span>
<span class="normal">1468</span>
<span class="normal">1469</span>
<span class="normal">1470</span>
<span class="normal">1471</span>
<span class="normal">1472</span>
<span class="normal">1473</span>
<span class="normal">1474</span>
<span class="normal">1475</span>
<span class="normal">1476</span>
<span class="normal">1477</span>
<span class="normal">1478</span>
<span class="normal">1479</span>
<span class="normal">1480</span>
<span class="normal">1481</span>
<span class="normal">1482</span>
<span class="normal">1483</span>
<span class="normal">1484</span>
<span class="normal">1485</span>
<span class="normal">1486</span>
<span class="normal">1487</span>
<span class="normal">1488</span>
<span class="normal">1489</span>
<span class="normal">1490</span>
<span class="normal">1491</span>
<span class="normal">1492</span>
<span class="normal">1493</span>
<span class="normal">1494</span>
<span class="normal">1495</span>
<span class="normal">1496</span>
<span class="normal">1497</span>
<span class="normal">1498</span>
<span class="normal">1499</span>
<span class="normal">1500</span>
<span class="normal">1501</span>
<span class="normal">1502</span>
<span class="normal">1503</span>
<span class="normal">1504</span>
<span class="normal">1505</span>
<span class="normal">1506</span>
<span class="normal">1507</span>
<span class="normal">1508</span>
<span class="normal">1509</span>
<span class="normal">1510</span>
<span class="normal">1511</span>
<span class="normal">1512</span>
<span class="normal">1513</span>
<span class="normal">1514</span>
<span class="normal">1515</span>
<span class="normal">1516</span>
<span class="normal">1517</span>
<span class="normal">1518</span>
<span class="normal">1519</span>
<span class="normal">1520</span>
<span class="normal">1521</span>
<span class="normal">1522</span>
<span class="normal">1523</span>
<span class="normal">1524</span>
<span class="normal">1525</span>
<span class="normal">1526</span>
<span class="normal">1527</span>
<span class="normal">1528</span>
<span class="normal">1529</span>
<span class="normal">1530</span>
<span class="normal">1531</span>
<span class="normal">1532</span>
<span class="normal">1533</span>
<span class="normal">1534</span>
<span class="normal">1535</span>
<span class="normal">1536</span>
<span class="normal">1537</span>
<span class="normal">1538</span>
<span class="normal">1539</span>
<span class="normal">1540</span>
<span class="normal">1541</span>
<span class="normal">1542</span>
<span class="normal">1543</span>
<span class="normal">1544</span>
<span class="normal">1545</span>
<span class="normal">1546</span>
<span class="normal">1547</span>
<span class="normal">1548</span>
<span class="normal">1549</span>
<span class="normal">1550</span>
<span class="normal">1551</span>
<span class="normal">1552</span>
<span class="normal">1553</span>
<span class="normal">1554</span>
<span class="normal">1555</span>
<span class="normal">1556</span>
<span class="normal">1557</span>
<span class="normal">1558</span>
<span class="normal">1559</span>
<span class="normal">1560</span>
<span class="normal">1561</span>
<span class="normal">1562</span>
<span class="normal">1563</span>
<span class="normal">1564</span>
<span class="normal">1565</span>
<span class="normal">1566</span>
<span class="normal">1567</span>
<span class="normal">1568</span>
<span class="normal">1569</span>
<span class="normal">1570</span>
<span class="normal">1571</span>
<span class="normal">1572</span>
<span class="normal">1573</span>
<span class="normal">1574</span>
<span class="normal">1575</span>
<span class="normal">1576</span>
<span class="normal">1577</span>
<span class="normal">1578</span>
<span class="normal">1579</span>
<span class="normal">1580</span>
<span class="normal">1581</span>
<span class="normal">1582</span>
<span class="normal">1583</span>
<span class="normal">1584</span>
<span class="normal">1585</span>
<span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">BatchCopy</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;A class for copying data in batches and applying a transformation function.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">channels_last</span><span class="p">:</span> <span class="nb">bool</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">channels_last</span> <span class="o">=</span> <span class="n">channels_last</span>

    <span class="k">def</span> <span class="nf">_single_copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data_interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dump_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">transformation</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copy data from a single h5py.Dataset to another h5py.Dataset in batches.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (h5py.Dataset, optional):  (Default value = None)</span>
<span class="sd">            data_interval (list, optional): The interval of the data to be copied. (Default value = None)</span>
<span class="sd">            batch_size (int, optional): The size of the batch to be copied. (Default value = None)</span>
<span class="sd">            dump_path (str, optional): The path where the new h5py.Dataset will be saved. (Default value = None)</span>
<span class="sd">            transformation (callable, optional):  (Default value = lambda data: data)</span>

<span class="sd">        Returns:</span>
<span class="sd">            h5py.Dataset: The new h5py.Dataset after the copy process.</span>

<span class="sd">        Note:</span>
<span class="sd">            - Copy data from data_file.h5/data to data_copy.h5/data with a batch size of 1000:</span>
<span class="sd">            - The input must be an h5py.Dataset.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = h5py.File(&quot;data_file.h5&quot;, &quot;r&quot;)</span>
<span class="sd">            &gt;&gt;&gt; batch_copy = BatchCopy()</span>
<span class="sd">            &gt;&gt;&gt; dset = batch_copy._single_copy(data=data[&quot;data&quot;], data_interval=[0, 100000], batch_size=1000, dump_path=&quot;data_copy.h5&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">),</span> <span class="s2">&quot;The input must be h5py.Dataset&quot;</span>

        <span class="n">variables_list</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>
        <span class="n">data_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span> <span class="o">+</span> <span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">data_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">dump_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="p">[(</span><span class="n">var</span><span class="p">,</span> <span class="s2">&quot;&lt;f8&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables_list</span><span class="p">]</span>

        <span class="n">dset</span> <span class="o">=</span> <span class="n">data_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">data_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">MemorySizeEval</span><span class="p">):</span>
            <span class="n">n_samples</span> <span class="o">=</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">(</span><span class="n">max_batches</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Constructing the normalization  using the reference data</span>
        <span class="n">batches</span> <span class="o">=</span> <span class="n">batchdomain_constructor</span><span class="p">(</span><span class="n">data_interval</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
        <span class="n">dset_batches</span> <span class="o">=</span> <span class="n">batchdomain_constructor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">dset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">batch_size</span><span class="p">)</span>

        <span class="n">variables_names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span>

        <span class="n">n_variables</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">batch_id</span><span class="p">,</span> <span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">d_batch</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">batches</span><span class="p">,</span> <span class="n">dset_batches</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Copying batch </span><span class="si">{</span><span class="n">batch_id</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span><span class="si">}</span><span class="s2"> batch_size=</span><span class="si">{</span><span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">-</span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="c1"># The variables dimension is the last one</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels_last</span><span class="p">:</span>
                <span class="c1"># TODO this is a restrictive way of doing it. It must be more flexible.</span>
                <span class="c1"># .transpose((0, 4, 2, 3, 1))</span>
                <span class="n">chunk_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">batch</span><span class="p">)]</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="nb">float</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)))</span>
            <span class="c1"># The variables dimension is the second one</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">chunk_data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">batch</span><span class="p">)]</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="nb">float</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)))</span>

            <span class="n">chunk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">fromarrays</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">chunk_data</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">n_variables</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">names</span><span class="o">=</span><span class="n">variables_names</span><span class="p">,</span>
                <span class="n">formats</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables_names</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="s2">&quot;f8&quot;</span><span class="p">]),</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">dset</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                <span class="n">chunk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">chunk_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="n">dset</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">d_batch</span><span class="p">)]</span> <span class="o">=</span> <span class="n">transformation</span><span class="p">(</span><span class="n">chunk_data</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">dset</span>

    <span class="k">def</span> <span class="nf">_multiple_copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data_interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dump_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">transformation</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copy and concatenate multiple h5py.Dataset objects into a single h5py.Dataset object.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (list, optional): A list of h5py.Dataset objects to be concatenated. (Default value = None)</span>
<span class="sd">            data_interval (list, optional): A list of two integers indicating the start and end index of the data to be concatenated. (Default value = None)</span>
<span class="sd">            batch_size (int, optional): The number of samples to be processed at a time. (Default value = None)</span>
<span class="sd">            dump_path (str, optional): The file path where the concatenated h5py.Dataset object will be saved. (Default value = None)</span>
<span class="sd">            transformation (callable, optional):  (Default value = lambda data: data)</span>

<span class="sd">        Returns:</span>
<span class="sd">            h5py.Dataset: The concatenated h5py.Dataset object.</span>

<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">assert</span> <span class="nb">all</span><span class="p">(</span>
            <span class="p">[</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">di</span><span class="p">,</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">)</span> <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">data</span><span class="p">]</span>
        <span class="p">),</span> <span class="s2">&quot;All inputs must be h5py.Dataset&quot;</span>

        <span class="n">variables_list</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">di</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">data</span><span class="p">],</span> <span class="p">[])</span>
        <span class="n">data_shape</span> <span class="o">=</span> <span class="p">(</span><span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">],)</span> <span class="o">+</span> <span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>

        <span class="n">data_file</span> <span class="o">=</span> <span class="n">h5py</span><span class="o">.</span><span class="n">File</span><span class="p">(</span><span class="n">dump_path</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>
        <span class="n">dtype</span> <span class="o">=</span> <span class="p">[(</span><span class="n">var</span><span class="p">,</span> <span class="s2">&quot;&lt;f8&quot;</span><span class="p">)</span> <span class="k">for</span> <span class="n">var</span> <span class="ow">in</span> <span class="n">variables_list</span><span class="p">]</span>

        <span class="n">dset</span> <span class="o">=</span> <span class="n">data_file</span><span class="o">.</span><span class="n">create_dataset</span><span class="p">(</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">data_shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">MemorySizeEval</span><span class="p">):</span>
            <span class="n">n_samples</span> <span class="o">=</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">data_interval</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">batch_size</span> <span class="o">=</span> <span class="n">batch_size</span><span class="p">(</span><span class="n">max_batches</span><span class="o">=</span><span class="n">n_samples</span><span class="p">,</span> <span class="n">shape</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">pass</span>

        <span class="c1"># Constructing the normalization  using the reference data</span>
        <span class="n">batches</span> <span class="o">=</span> <span class="n">batchdomain_constructor</span><span class="p">(</span><span class="n">data_interval</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">)</span>
        <span class="n">dset_batches</span> <span class="o">=</span> <span class="n">batchdomain_constructor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">dset</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]],</span> <span class="n">batch_size</span><span class="p">)</span>

        <span class="n">variables_names</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">list</span><span class="p">(</span><span class="n">di</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">data</span><span class="p">],</span> <span class="p">[])</span>

        <span class="n">n_variables</span> <span class="o">=</span> <span class="nb">sum</span><span class="p">([</span><span class="nb">len</span><span class="p">(</span><span class="n">di</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)</span> <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">data</span><span class="p">])</span>

        <span class="k">for</span> <span class="n">batch_id</span><span class="p">,</span> <span class="p">(</span><span class="n">batch</span><span class="p">,</span> <span class="n">d_batch</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">batches</span><span class="p">,</span> <span class="n">dset_batches</span><span class="p">)):</span>
            <span class="nb">print</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Copying and concatenating the batches </span><span class="si">{</span><span class="n">batch_id</span><span class="o">+</span><span class="mi">1</span><span class="si">}</span><span class="s2">/</span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">batches</span><span class="p">)</span><span class="si">}</span><span class="s2"> batch_size=</span><span class="si">{</span><span class="n">batch</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">batch</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="p">)</span>

            <span class="c1"># The variables dimension is the last one</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">channels_last</span><span class="p">:</span>
                <span class="c1"># TODO this is a restrictive way of doing it. It must be more flexible.</span>
                <span class="n">chunk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">di</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">batch</span><span class="p">)]</span>
                        <span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="nb">float</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">di</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)))</span>
                        <span class="o">.</span><span class="n">transpose</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">))</span>
                        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">data</span>
                    <span class="p">],</span>
                    <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>
            <span class="c1"># The variables dimension is the second one</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">chunk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">stack</span><span class="p">(</span>
                    <span class="p">[</span>
                        <span class="n">di</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">batch</span><span class="p">)]</span><span class="o">.</span><span class="n">view</span><span class="p">((</span><span class="nb">float</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">di</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">names</span><span class="p">)))</span>
                        <span class="k">for</span> <span class="n">di</span> <span class="ow">in</span> <span class="n">data</span>
                    <span class="p">],</span>
                    <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">,</span>
                <span class="p">)</span>

            <span class="n">chunk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">records</span><span class="o">.</span><span class="n">fromarrays</span><span class="p">(</span>
                <span class="n">np</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">chunk_data</span><span class="p">[</span><span class="o">...</span><span class="p">],</span> <span class="n">n_variables</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">),</span>
                <span class="n">names</span><span class="o">=</span><span class="n">variables_names</span><span class="p">,</span>
                <span class="n">formats</span><span class="o">=</span><span class="s2">&quot;,&quot;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">variables_names</span><span class="p">)</span> <span class="o">*</span> <span class="p">[</span><span class="s2">&quot;f8&quot;</span><span class="p">]),</span>
            <span class="p">)</span>

            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">chunk_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">&gt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">dset</span><span class="o">.</span><span class="n">shape</span><span class="p">):</span>
                <span class="n">chunk_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">squeeze</span><span class="p">(</span><span class="n">chunk_data</span><span class="p">,</span> <span class="n">axis</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>

            <span class="n">dset</span><span class="p">[</span><span class="nb">slice</span><span class="p">(</span><span class="o">*</span><span class="n">d_batch</span><span class="p">)]</span> <span class="o">=</span> <span class="n">transformation</span><span class="p">(</span><span class="n">chunk_data</span><span class="p">[</span><span class="o">...</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">dset</span>

    <span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">data</span><span class="p">:</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">data_interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">dump_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">transformation</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copies the data from h5py.Dataset to a new h5py.Dataset file.</span>
<span class="sd">        It allows to apply a transformation function to the data.</span>

<span class="sd">        Args:</span>
<span class="sd">            data (h5py.Dataset, optional): input data to be copied (Default value = None)</span>
<span class="sd">            data_interval (list, optional): the range of the data to be copied (Default value = None)</span>
<span class="sd">            batch_size (int, optional): the size of the batches to be used to copy the data (Default value = None)</span>
<span class="sd">            dump_path (str, optional): the path of the file where the data will be copied (Default value = None)</span>
<span class="sd">            transformation (callable, optional):  (Default value = lambda data: data)</span>

<span class="sd">        Returns:</span>
<span class="sd">            h5py.Dataset: The copied data</span>
<span class="sd">        Note:</span>
<span class="sd">            - If the data is a list of h5py.Dataset, it will call the `_multiple_copy` function.</span>
<span class="sd">        Example:</span>

<span class="sd">            &gt;&gt;&gt; data = h5py.File(&#39;data.h5&#39;, &#39;r&#39;)</span>
<span class="sd">            &gt;&gt;&gt; data_interval = [0, 100]</span>
<span class="sd">            &gt;&gt;&gt; batch_size = 1000</span>
<span class="sd">            &gt;&gt;&gt; dump_path = &#39;copied_data.h5&#39;</span>
<span class="sd">            &gt;&gt;&gt; transformation = lambda x: x*2</span>
<span class="sd">            &gt;&gt;&gt; copied_data = copy(data, data_interval, batch_size, dump_path, transformation)</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multiple_copy</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">data_interval</span><span class="o">=</span><span class="n">data_interval</span><span class="p">,</span>
                <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                <span class="n">dump_path</span><span class="o">=</span><span class="n">dump_path</span><span class="p">,</span>
                <span class="n">transformation</span><span class="o">=</span><span class="n">transformation</span><span class="p">,</span>
            <span class="p">)</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_single_copy</span><span class="p">(</span>
                <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
                <span class="n">data_interval</span><span class="o">=</span><span class="n">data_interval</span><span class="p">,</span>
                <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
                <span class="n">dump_path</span><span class="o">=</span><span class="n">dump_path</span><span class="p">,</span>
                <span class="n">transformation</span><span class="o">=</span><span class="n">transformation</span><span class="p">,</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.BatchCopy.copy" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">copy</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_interval</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">batch_size</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dump_path</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">transformation</span><span class="o">=</span><span class="k">lambda</span> <span class="p">:</span> <span class="n">data</span><span class="p">)</span></code>

<a href="#simulai.io.BatchCopy.copy" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Copies the data from h5py.Dataset to a new h5py.Dataset file.
It allows to apply a transformation function to the data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>data</code></td>
          <td>
                <code><span title="h5py.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>input data to be copied (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>data_interval</code></td>
          <td>
                <code>list</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the range of the data to be copied (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>batch_size</code></td>
          <td>
                <code>int</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the size of the batches to be used to copy the data (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>dump_path</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>the path of the file where the data will be copied (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>transformation</code></td>
          <td>
                <code>callable</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = lambda data: data)</p>
            </div>
          </td>
          <td>
                <code>lambda : data</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="h5py.Dataset">Dataset</span></code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>h5py.Dataset: The copied data</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>
      <p>Note:
    - If the data is a list of h5py.Dataset, it will call the <code>_multiple_copy</code> function.
Example:</p>
<pre><code>&gt;&gt;&gt; data = h5py.File('data.h5', 'r')
&gt;&gt;&gt; data_interval = [0, 100]
&gt;&gt;&gt; batch_size = 1000
&gt;&gt;&gt; dump_path = 'copied_data.h5'
&gt;&gt;&gt; transformation = lambda x: x*2
&gt;&gt;&gt; copied_data = copy(data, data_interval, batch_size, dump_path, transformation)
</code></pre>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1586</span>
<span class="normal">1587</span>
<span class="normal">1588</span>
<span class="normal">1589</span>
<span class="normal">1590</span>
<span class="normal">1591</span>
<span class="normal">1592</span>
<span class="normal">1593</span>
<span class="normal">1594</span>
<span class="normal">1595</span>
<span class="normal">1596</span>
<span class="normal">1597</span>
<span class="normal">1598</span>
<span class="normal">1599</span>
<span class="normal">1600</span>
<span class="normal">1601</span>
<span class="normal">1602</span>
<span class="normal">1603</span>
<span class="normal">1604</span>
<span class="normal">1605</span>
<span class="normal">1606</span>
<span class="normal">1607</span>
<span class="normal">1608</span>
<span class="normal">1609</span>
<span class="normal">1610</span>
<span class="normal">1611</span>
<span class="normal">1612</span>
<span class="normal">1613</span>
<span class="normal">1614</span>
<span class="normal">1615</span>
<span class="normal">1616</span>
<span class="normal">1617</span>
<span class="normal">1618</span>
<span class="normal">1619</span>
<span class="normal">1620</span>
<span class="normal">1621</span>
<span class="normal">1622</span>
<span class="normal">1623</span>
<span class="normal">1624</span>
<span class="normal">1625</span>
<span class="normal">1626</span>
<span class="normal">1627</span>
<span class="normal">1628</span>
<span class="normal">1629</span>
<span class="normal">1630</span>
<span class="normal">1631</span>
<span class="normal">1632</span>
<span class="normal">1633</span>
<span class="normal">1634</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">copy</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">data</span><span class="p">:</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">data_interval</span><span class="p">:</span> <span class="nb">list</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">batch_size</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">dump_path</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">transformation</span><span class="p">:</span> <span class="nb">callable</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">data</span><span class="p">:</span> <span class="n">data</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">h5py</span><span class="o">.</span><span class="n">Dataset</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Copies the data from h5py.Dataset to a new h5py.Dataset file.</span>
<span class="sd">    It allows to apply a transformation function to the data.</span>

<span class="sd">    Args:</span>
<span class="sd">        data (h5py.Dataset, optional): input data to be copied (Default value = None)</span>
<span class="sd">        data_interval (list, optional): the range of the data to be copied (Default value = None)</span>
<span class="sd">        batch_size (int, optional): the size of the batches to be used to copy the data (Default value = None)</span>
<span class="sd">        dump_path (str, optional): the path of the file where the data will be copied (Default value = None)</span>
<span class="sd">        transformation (callable, optional):  (Default value = lambda data: data)</span>

<span class="sd">    Returns:</span>
<span class="sd">        h5py.Dataset: The copied data</span>
<span class="sd">    Note:</span>
<span class="sd">        - If the data is a list of h5py.Dataset, it will call the `_multiple_copy` function.</span>
<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; data = h5py.File(&#39;data.h5&#39;, &#39;r&#39;)</span>
<span class="sd">        &gt;&gt;&gt; data_interval = [0, 100]</span>
<span class="sd">        &gt;&gt;&gt; batch_size = 1000</span>
<span class="sd">        &gt;&gt;&gt; dump_path = &#39;copied_data.h5&#39;</span>
<span class="sd">        &gt;&gt;&gt; transformation = lambda x: x*2</span>
<span class="sd">        &gt;&gt;&gt; copied_data = copy(data, data_interval, batch_size, dump_path, transformation)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_multiple_copy</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">data_interval</span><span class="o">=</span><span class="n">data_interval</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">dump_path</span><span class="o">=</span><span class="n">dump_path</span><span class="p">,</span>
            <span class="n">transformation</span><span class="o">=</span><span class="n">transformation</span><span class="p">,</span>
        <span class="p">)</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_single_copy</span><span class="p">(</span>
            <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span>
            <span class="n">data_interval</span><span class="o">=</span><span class="n">data_interval</span><span class="p">,</span>
            <span class="n">batch_size</span><span class="o">=</span><span class="n">batch_size</span><span class="p">,</span>
            <span class="n">dump_path</span><span class="o">=</span><span class="n">dump_path</span><span class="p">,</span>
            <span class="n">transformation</span><span class="o">=</span><span class="n">transformation</span><span class="p">,</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="maketensor"><red>MakeTensor</red><a class="headerlink" href="#maketensor" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.MakeTensor"></a>
  <div class="doc doc-contents first">

  
      <p>This class is used to make torch tensors from numpy arrays or dictionaries.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_names</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of input names.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>output_names</code></td>
          <td>
                <code><span title="typing.List">List</span>[str]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>list of output names.</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
    </tbody>
  </table>

<details class="note" open>
  <summary>Note</summary>
  <ul>
<li>input_tensors will be a list of tensors in case of numpy array and dictionary inputs.</li>
<li>The input_data should be numpy array with shape (batch_size, features_size) or dictionary with keys from input_names and values with shape (batch_size, features_size) if input_names and output_names are provided.</li>
<li>The input_data will be converted to float32 dtype.</li>
<li>The input_data will be put on the device specified by the device parameter, which defaults to 'cpu'.</li>
<li>If input_data is None, it will raise an exception.</li>
</ul>
</details>      <p>Example:</p>
<pre><code># Creating a MakeTensor object with input and output names

# Converting numpy array to torch tensor

# Converting dictionary to torch tensors

&gt;&gt;&gt; mt = MakeTensor(input_names=["input_1", "input_2"], output_names=["output"])

&gt;&gt;&gt; input_data = np.random.randn(10, 3)
&gt;&gt;&gt; input_tensors = mt(input_data)

&gt;&gt;&gt; input_data = {"input_1": np.random.randn(10, 3), "input_2": np.random.randn(10, 4)}
&gt;&gt;&gt; input_tensors = mt(input_data)
</code></pre>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1637</span>
<span class="normal">1638</span>
<span class="normal">1639</span>
<span class="normal">1640</span>
<span class="normal">1641</span>
<span class="normal">1642</span>
<span class="normal">1643</span>
<span class="normal">1644</span>
<span class="normal">1645</span>
<span class="normal">1646</span>
<span class="normal">1647</span>
<span class="normal">1648</span>
<span class="normal">1649</span>
<span class="normal">1650</span>
<span class="normal">1651</span>
<span class="normal">1652</span>
<span class="normal">1653</span>
<span class="normal">1654</span>
<span class="normal">1655</span>
<span class="normal">1656</span>
<span class="normal">1657</span>
<span class="normal">1658</span>
<span class="normal">1659</span>
<span class="normal">1660</span>
<span class="normal">1661</span>
<span class="normal">1662</span>
<span class="normal">1663</span>
<span class="normal">1664</span>
<span class="normal">1665</span>
<span class="normal">1666</span>
<span class="normal">1667</span>
<span class="normal">1668</span>
<span class="normal">1669</span>
<span class="normal">1670</span>
<span class="normal">1671</span>
<span class="normal">1672</span>
<span class="normal">1673</span>
<span class="normal">1674</span>
<span class="normal">1675</span>
<span class="normal">1676</span>
<span class="normal">1677</span>
<span class="normal">1678</span>
<span class="normal">1679</span>
<span class="normal">1680</span>
<span class="normal">1681</span>
<span class="normal">1682</span>
<span class="normal">1683</span>
<span class="normal">1684</span>
<span class="normal">1685</span>
<span class="normal">1686</span>
<span class="normal">1687</span>
<span class="normal">1688</span>
<span class="normal">1689</span>
<span class="normal">1690</span>
<span class="normal">1691</span>
<span class="normal">1692</span>
<span class="normal">1693</span>
<span class="normal">1694</span>
<span class="normal">1695</span>
<span class="normal">1696</span>
<span class="normal">1697</span>
<span class="normal">1698</span>
<span class="normal">1699</span>
<span class="normal">1700</span>
<span class="normal">1701</span>
<span class="normal">1702</span>
<span class="normal">1703</span>
<span class="normal">1704</span>
<span class="normal">1705</span>
<span class="normal">1706</span>
<span class="normal">1707</span>
<span class="normal">1708</span>
<span class="normal">1709</span>
<span class="normal">1710</span>
<span class="normal">1711</span>
<span class="normal">1712</span>
<span class="normal">1713</span>
<span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">MakeTensor</span><span class="p">:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;This class is used to make torch tensors from numpy arrays or dictionaries.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_names (List[str]): list of input names.</span>
<span class="sd">        output_names (List[str]): list of output names.</span>

<span class="sd">    Note:</span>
<span class="sd">        - input_tensors will be a list of tensors in case of numpy array and dictionary inputs.</span>
<span class="sd">        - The input_data should be numpy array with shape (batch_size, features_size) or dictionary with keys from input_names and values with shape (batch_size, features_size) if input_names and output_names are provided.</span>
<span class="sd">        - The input_data will be converted to float32 dtype.</span>
<span class="sd">        - The input_data will be put on the device specified by the device parameter, which defaults to &#39;cpu&#39;.</span>
<span class="sd">        - If input_data is None, it will raise an exception.</span>
<span class="sd">    Example:</span>

<span class="sd">        # Creating a MakeTensor object with input and output names</span>

<span class="sd">        # Converting numpy array to torch tensor</span>

<span class="sd">        # Converting dictionary to torch tensors</span>

<span class="sd">        &gt;&gt;&gt; mt = MakeTensor(input_names=[&quot;input_1&quot;, &quot;input_2&quot;], output_names=[&quot;output&quot;])</span>

<span class="sd">        &gt;&gt;&gt; input_data = np.random.randn(10, 3)</span>
<span class="sd">        &gt;&gt;&gt; input_tensors = mt(input_data)</span>

<span class="sd">        &gt;&gt;&gt; input_data = {&quot;input_1&quot;: np.random.randn(10, 3), &quot;input_2&quot;: np.random.randn(10, 4)}</span>
<span class="sd">        &gt;&gt;&gt; input_tensors = mt(input_data)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_names</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_names</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_names</span> <span class="o">=</span> <span class="n">input_names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_names</span> <span class="o">=</span> <span class="n">output_names</span>

    <span class="k">def</span> <span class="nf">_make_tensor</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Convert input_data to a list of torch tensors.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data (np.ndarray, optional):  (Default value = None)</span>
<span class="sd">            device (str, optional):  (Default value = &quot;cpu&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            List[torch.Tensor]: list of tensors.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inputs_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">torch</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">dim</span><span class="o">=-</span><span class="mi">1</span><span class="p">))</span>

        <span class="k">for</span> <span class="n">vv</span><span class="p">,</span> <span class="n">var</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">inputs_list</span><span class="p">):</span>
            <span class="n">var</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">var</span> <span class="o">=</span> <span class="n">var</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">inputs_list</span><span class="p">[</span><span class="n">vv</span><span class="p">]</span> <span class="o">=</span> <span class="n">var</span>
            <span class="c1"># var = var[..., None]</span>

        <span class="k">return</span> <span class="n">inputs_list</span>

    <span class="k">def</span> <span class="nf">_make_tensor_dict</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="nb">dict</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">dict</span><span class="p">:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Convert input_data to a dictionary of torch tensors.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data (dict, optional):  (Default value = None)</span>
<span class="sd">            device (str, optional):  (Default value = &quot;cpu&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict: dictionary of tensors.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">inputs_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">input_data</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="n">item</span><span class="o">.</span><span class="n">requires_grad</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
            <span class="n">inputs_dict</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">item</span>

        <span class="k">return</span> <span class="n">inputs_dict</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">input_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
        <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Make tensors from input_data.</span>

<span class="sd">        Args:</span>
<span class="sd">            input_data (Union[np.ndarray, torch.Tensor, Dict[str, np.ndarray]], optional): input data to be converted. (Default value = None)</span>
<span class="sd">            device (str, optional):  (Default value = &quot;cpu&quot;)</span>

<span class="sd">        Returns:</span>
<span class="sd">            Union[List[torch.Tensor], dict]:</span>

<span class="sd">        Raises:</span>
<span class="sd">            - Exception:</span>


<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
            <span class="n">input_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">input_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">ARRAY_DTYPE</span><span class="p">))</span>

            <span class="n">inputs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_tensor</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">inputs_list</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
            <span class="n">inputs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_tensor</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">inputs_list</span>

        <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
            <span class="n">inputs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_tensor_dict</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

            <span class="k">return</span> <span class="n">inputs_list</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;The type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> for input_data is not supported.&quot;</span>
            <span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.MakeTensor.__call__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__call__</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="s1">&#39;cpu&#39;</span><span class="p">)</span></code>

<a href="#simulai.io.MakeTensor.__call__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Make tensors from input_data.</p>



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>input_data</code></td>
          <td>
                <code><span title="typing.Union">Union</span>[<span title="numpy.ndarray">ndarray</span>, <span title="torch.Tensor">Tensor</span>, <span title="typing.Dict">Dict</span>[str, <span title="numpy.ndarray">ndarray</span>]]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>input data to be converted. (Default value = None)</p>
            </div>
          </td>
          <td>
                <code>None</code>
          </td>
        </tr>
        <tr>
          <td><code>device</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>(Default value = "cpu")</p>
            </div>
          </td>
          <td>
                <code>&#39;cpu&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Returns:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code><span title="typing.List">List</span>[<span title="torch.Tensor">Tensor</span>]</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>Union[List[torch.Tensor], dict]:</p>
            </div>
          </td>
        </tr>
    </tbody>
  </table>



  <p><strong>Raises:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Type</th>
        <th>Description</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td>
                <code>-Exception</code>
          </td>
          <td>
            <div class="doc-md-description">
              
            </div>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1714</span>
<span class="normal">1715</span>
<span class="normal">1716</span>
<span class="normal">1717</span>
<span class="normal">1718</span>
<span class="normal">1719</span>
<span class="normal">1720</span>
<span class="normal">1721</span>
<span class="normal">1722</span>
<span class="normal">1723</span>
<span class="normal">1724</span>
<span class="normal">1725</span>
<span class="normal">1726</span>
<span class="normal">1727</span>
<span class="normal">1728</span>
<span class="normal">1729</span>
<span class="normal">1730</span>
<span class="normal">1731</span>
<span class="normal">1732</span>
<span class="normal">1733</span>
<span class="normal">1734</span>
<span class="normal">1735</span>
<span class="normal">1736</span>
<span class="normal">1737</span>
<span class="normal">1738</span>
<span class="normal">1739</span>
<span class="normal">1740</span>
<span class="normal">1741</span>
<span class="normal">1742</span>
<span class="normal">1743</span>
<span class="normal">1744</span>
<span class="normal">1745</span>
<span class="normal">1746</span>
<span class="normal">1747</span>
<span class="normal">1748</span>
<span class="normal">1749</span>
<span class="normal">1750</span>
<span class="normal">1751</span>
<span class="normal">1752</span>
<span class="normal">1753</span>
<span class="normal">1754</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span>
    <span class="bp">self</span><span class="p">,</span>
    <span class="n">input_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">,</span> <span class="n">Dict</span><span class="p">[</span><span class="nb">str</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">]]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span>
    <span class="n">device</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;cpu&quot;</span><span class="p">,</span>
<span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;Make tensors from input_data.</span>

<span class="sd">    Args:</span>
<span class="sd">        input_data (Union[np.ndarray, torch.Tensor, Dict[str, np.ndarray]], optional): input data to be converted. (Default value = None)</span>
<span class="sd">        device (str, optional):  (Default value = &quot;cpu&quot;)</span>

<span class="sd">    Returns:</span>
<span class="sd">        Union[List[torch.Tensor], dict]:</span>

<span class="sd">    Raises:</span>
<span class="sd">        - Exception:</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span> <span class="o">==</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">:</span>
        <span class="n">input_data</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">input_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">ARRAY_DTYPE</span><span class="p">))</span>

        <span class="n">inputs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_tensor</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inputs_list</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span> <span class="o">==</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>
        <span class="n">inputs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_tensor</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inputs_list</span>

    <span class="k">elif</span> <span class="nb">type</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span> <span class="o">==</span> <span class="nb">dict</span><span class="p">:</span>
        <span class="n">inputs_list</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_tensor_dict</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="n">input_data</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">device</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">inputs_list</span>

    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span>
            <span class="sa">f</span><span class="s2">&quot;The type </span><span class="si">{</span><span class="nb">type</span><span class="p">(</span><span class="n">input_data</span><span class="p">)</span><span class="si">}</span><span class="s2"> for input_data is not supported.&quot;</span>
        <span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div><h2 id="gaussiannoise"><red>GaussianNoise</red><a class="headerlink" href="#gaussiannoise" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.GaussianNoise"></a>
  <div class="doc doc-contents first">
          <p class="doc doc-class-bases">
            Bases: <code><span title="simulai.abstract.Dataset">Dataset</span></code></p>

  
      <p>GaussianNoise(stddev=0.01, input_data=None)
A dataset that applies Gaussian noise to input data.</p>
<p>Example:</p>
<pre><code>&gt;&gt;&gt; import numpy as np
&gt;&gt;&gt; input_data = np.random.rand(100,100)
&gt;&gt;&gt; dataset = GaussianNoise(stddev=0.05, input_data=input_data)
&gt;&gt;&gt; dataset.size()
(100, 100)
</code></pre>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1757</span>
<span class="normal">1758</span>
<span class="normal">1759</span>
<span class="normal">1760</span>
<span class="normal">1761</span>
<span class="normal">1762</span>
<span class="normal">1763</span>
<span class="normal">1764</span>
<span class="normal">1765</span>
<span class="normal">1766</span>
<span class="normal">1767</span>
<span class="normal">1768</span>
<span class="normal">1769</span>
<span class="normal">1770</span>
<span class="normal">1771</span>
<span class="normal">1772</span>
<span class="normal">1773</span>
<span class="normal">1774</span>
<span class="normal">1775</span>
<span class="normal">1776</span>
<span class="normal">1777</span>
<span class="normal">1778</span>
<span class="normal">1779</span>
<span class="normal">1780</span>
<span class="normal">1781</span>
<span class="normal">1782</span>
<span class="normal">1783</span>
<span class="normal">1784</span>
<span class="normal">1785</span>
<span class="normal">1786</span>
<span class="normal">1787</span>
<span class="normal">1788</span>
<span class="normal">1789</span>
<span class="normal">1790</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">GaussianNoise</span><span class="p">(</span><span class="n">Dataset</span><span class="p">):</span>
<span class="w">    </span><span class="sa">r</span><span class="sd">&quot;&quot;&quot;GaussianNoise(stddev=0.01, input_data=None)</span>
<span class="sd">    A dataset that applies Gaussian noise to input data.</span>

<span class="sd">    Example:</span>

<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; input_data = np.random.rand(100,100)</span>
<span class="sd">        &gt;&gt;&gt; dataset = GaussianNoise(stddev=0.05, input_data=input_data)</span>
<span class="sd">        &gt;&gt;&gt; dataset.size()</span>
<span class="sd">        (100, 100)</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span> <span class="n">stddev</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.01</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Dataset</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">stddev</span> <span class="o">=</span> <span class="n">stddev</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="n">input_data_</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">input_data</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="s2">&quot;float32&quot;</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">input_data_</span> <span class="o">=</span> <span class="n">input_data</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">input_data</span> <span class="o">=</span> <span class="n">input_data_</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">data_shape</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">input_data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">data_shape</span>

    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">stddev</span> <span class="o">*</span> <span class="n">torch</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">data_shape</span><span class="p">))</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_data</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">











  </div>

  </div>

</div><h2 id="tokenizer"><red>Tokenizer</red><a class="headerlink" href="#tokenizer" title="Permanent link">#</a></h2>


<div class="doc doc-object doc-class">



<a id="simulai.io.Tokenizer"></a>
  <div class="doc doc-contents first">

  
      <p>Wrapper for multiple tokenization approaches</p>

            <details class="quote">
              <summary>Source code in <code>simulai/io.py</code></summary>
              <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1792</span>
<span class="normal">1793</span>
<span class="normal">1794</span>
<span class="normal">1795</span>
<span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span>
<span class="normal">1809</span>
<span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span>
<span class="normal">1815</span>
<span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span>
<span class="normal">1821</span>
<span class="normal">1822</span>
<span class="normal">1823</span>
<span class="normal">1824</span>
<span class="normal">1825</span>
<span class="normal">1826</span>
<span class="normal">1827</span>
<span class="normal">1828</span>
<span class="normal">1829</span>
<span class="normal">1830</span>
<span class="normal">1831</span>
<span class="normal">1832</span>
<span class="normal">1833</span>
<span class="normal">1834</span>
<span class="normal">1835</span>
<span class="normal">1836</span>
<span class="normal">1837</span>
<span class="normal">1838</span>
<span class="normal">1839</span>
<span class="normal">1840</span>
<span class="normal">1841</span>
<span class="normal">1842</span>
<span class="normal">1843</span>
<span class="normal">1844</span>
<span class="normal">1845</span>
<span class="normal">1846</span>
<span class="normal">1847</span>
<span class="normal">1848</span>
<span class="normal">1849</span>
<span class="normal">1850</span>
<span class="normal">1851</span>
<span class="normal">1852</span>
<span class="normal">1853</span>
<span class="normal">1854</span>
<span class="normal">1855</span>
<span class="normal">1856</span>
<span class="normal">1857</span>
<span class="normal">1858</span>
<span class="normal">1859</span>
<span class="normal">1860</span>
<span class="normal">1861</span>
<span class="normal">1862</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">class</span> <span class="nc">Tokenizer</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Wrapper for multiple tokenization approaches&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time_indexer&quot;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Args:</span>
<span class="sd">            kind (str): The kind of tokenization to be used. (Default value = &quot;time_indexer&quot;)</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kind</span>

        <span class="c1"># Tokenizer selection</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;time_indexer&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">input_tokenizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_time_input_sequence</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">target_tokenizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_time_target_sequence</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The tokenization option </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="si">}</span><span class="s2"> is not available.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_input_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generating the input sequence of tokens.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_tokenizer</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">generate_target_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span> 

<span class="w">        </span><span class="sd">&quot;&quot;&quot;Generating the target sequence of tokens.&quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_tokenizer</span><span class="p">(</span><span class="n">target_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_make_time_input_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
        <span class="n">src</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">num_step</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">step</span><span class="p">:</span><span class="nb">float</span><span class="o">=</span><span class="kc">None</span>
    <span class="p">)</span> <span class="o">-&gt;</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simple tokenization based on repeating samples</span>
<span class="sd">           and time-indexing them.</span>
<span class="sd">        Args:</span>
<span class="sd">            src (Union[np.ndarray, torch.Tensor]): The dataset to be tokenized.</span>
<span class="sd">            num_step (int): number of timesteps for each batch. (Default value: None)</span>
<span class="sd">            step (float): Size of the timestep. (Default value: None)</span>
<span class="sd">        Returns:</span>
<span class="sd">            Union[np.ndarray, torch.Tensor]: The tokenized input dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">dim</span> <span class="o">=</span> <span class="n">num_step</span>
        <span class="n">src</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">src</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">),</span> <span class="n">dim</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">src_shape</span> <span class="o">=</span> <span class="n">src</span><span class="o">.</span><span class="n">shape</span>
        <span class="n">src_shape_list</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">src_shape</span><span class="p">)</span>
        <span class="n">src_shape_list</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>

        <span class="n">src_final</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">tuple</span><span class="p">(</span><span class="n">src_shape_list</span><span class="p">))</span>
        <span class="n">src_final</span><span class="p">[:,</span> <span class="p">:,</span> <span class="p">:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">src</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_step</span><span class="p">):</span>
            <span class="n">src_final</span><span class="p">[:,</span> <span class="n">i</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">step</span> <span class="o">*</span> <span class="n">i</span>

        <span class="k">return</span> <span class="n">src_final</span><span class="p">[:</span><span class="o">-</span><span class="n">num_step</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_make_time_target_sequence</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> 
        <span class="n">src</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="n">num_step</span><span class="p">:</span><span class="nb">int</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">-&gt;</span>  <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">]:</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Simple tokenization based on repeating samples</span>
<span class="sd">           and time-indexing them.</span>
<span class="sd">        Args:</span>
<span class="sd">            src (Union[np.ndarray, torch.Tensor]): The dataset to be tokenized.</span>
<span class="sd">            num_step (int): number of timesteps for each batch. (Default value: None)</span>
<span class="sd">        Returns:</span>
<span class="sd">            Union[np.ndarray, torch.Tensor]: The tokenized target dataset.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">moving_window</span> <span class="o">=</span> <span class="n">MovingWindow</span><span class="p">(</span><span class="n">history_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">skip_size</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">horizon_size</span><span class="o">=</span><span class="n">num_step</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> 
        <span class="n">input_data</span><span class="p">,</span> <span class="n">output_data</span> <span class="o">=</span> <span class="n">moving_window</span><span class="p">(</span><span class="n">input_data</span><span class="o">=</span><span class="n">src</span><span class="p">,</span> <span class="n">output_data</span><span class="o">=</span><span class="n">src</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">([</span><span class="n">input_data</span><span class="p">,</span> <span class="n">output_data</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
            </details>

  

  <div class="doc doc-children">










<div class="doc doc-object doc-function">




<h2 id="simulai.io.Tokenizer.__init__" class="doc doc-heading">
          <code class="highlight language-python"><span class="fm">__init__</span><span class="p">(</span><span class="n">kind</span><span class="o">=</span><span class="s1">&#39;time_indexer&#39;</span><span class="p">)</span></code>

<a href="#simulai.io.Tokenizer.__init__" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  



  <p><strong>Parameters:</strong></p>
  <table>
    <thead>
      <tr>
        <th>Name</th>
        <th>Type</th>
        <th>Description</th>
        <th>Default</th>
      </tr>
    </thead>
    <tbody>
        <tr>
          <td><code>kind</code></td>
          <td>
                <code>str</code>
          </td>
          <td>
            <div class="doc-md-description">
              <p>The kind of tokenization to be used. (Default value = "time_indexer")</p>
            </div>
          </td>
          <td>
                <code>&#39;time_indexer&#39;</code>
          </td>
        </tr>
    </tbody>
  </table>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1796</span>
<span class="normal">1797</span>
<span class="normal">1798</span>
<span class="normal">1799</span>
<span class="normal">1800</span>
<span class="normal">1801</span>
<span class="normal">1802</span>
<span class="normal">1803</span>
<span class="normal">1804</span>
<span class="normal">1805</span>
<span class="normal">1806</span>
<span class="normal">1807</span>
<span class="normal">1808</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">kind</span><span class="p">:</span> <span class="nb">str</span> <span class="o">=</span> <span class="s2">&quot;time_indexer&quot;</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Args:</span>
<span class="sd">        kind (str): The kind of tokenization to be used. (Default value = &quot;time_indexer&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">=</span> <span class="n">kind</span>

    <span class="c1"># Tokenizer selection</span>
    <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">kind</span> <span class="o">==</span> <span class="s2">&quot;time_indexer&quot;</span><span class="p">:</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">input_tokenizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_time_input_sequence</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">target_tokenizer</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_make_time_target_sequence</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;The tokenization option </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">kind</span><span class="si">}</span><span class="s2"> is not available.&quot;</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.Tokenizer.generate_input_tokens" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_input_tokens</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#simulai.io.Tokenizer.generate_input_tokens" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Generating the input sequence of tokens.</p>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1810</span>
<span class="normal">1811</span>
<span class="normal">1812</span>
<span class="normal">1813</span>
<span class="normal">1814</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_input_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span>

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generating the input sequence of tokens.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">input_tokenizer</span><span class="p">(</span><span class="n">input_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>


<div class="doc doc-object doc-function">




<h2 id="simulai.io.Tokenizer.generate_target_tokens" class="doc doc-heading">
          <code class="highlight language-python"><span class="n">generate_target_tokens</span><span class="p">(</span><span class="n">target_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></code>

<a href="#simulai.io.Tokenizer.generate_target_tokens" class="headerlink" title="Permanent link">#</a></h2>


  <div class="doc doc-contents ">
  
      <p>Generating the target sequence of tokens.</p>

          <details class="quote">
            <summary>Source code in <code>simulai/io.py</code></summary>
            <div class="highlight"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre><span></span><span class="normal">1816</span>
<span class="normal">1817</span>
<span class="normal">1818</span>
<span class="normal">1819</span>
<span class="normal">1820</span></pre></div></td><td class="code"><div><pre><span></span><code><span class="k">def</span> <span class="nf">generate_target_tokens</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">target_data</span><span class="p">:</span> <span class="n">Union</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">],</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">torch</span><span class="o">.</span><span class="n">Tensor</span><span class="p">:</span> 

<span class="w">    </span><span class="sd">&quot;&quot;&quot;Generating the target sequence of tokens.&quot;&quot;&quot;</span>

    <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_tokenizer</span><span class="p">(</span><span class="n">target_data</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</code></pre></div></td></tr></table></div>
          </details>
  </div>

</div>



  </div>

  </div>

</div></p>
    </article>
</section>
<!-- endblock -->
            </main>

            
                    <!-- block preview -->
        <div class="row row-cols-md-3 text-center pt-md-3" id="component-preview">
            <div class="col themed-grid-col">
                <a rel="prev" href=".." class="nav-link">
                    <i class="fa fa-arrow-left"></i> Previous
                </a>
            </div>
            <div class="col themed-grid-col"></div>
            <div class="col themed-grid-col">
                <a rel="next" href="../simulai_file/" class="nav-link">
                    Next <i class="fa fa-arrow-right"></i>
                </a>
            </div>
        </div>
<!-- endblock -->
            

            
                    <!-- block footer -->
<footer class="pt-4 my-md-5 pt-md-5 border-top" id="component-footer">
    <div class="row">
        <div class="col-12 col-md">
                <!-- block copyright -->

    <small class="d-block mb-3">
        Made with
        <a href="https://github.com/FernandoCelmer/mkdocs-simple-blog" target="_blank" rel="noopener">
            Simple Blog for MkDocs
        </a>
    </small>

<!-- endblock -->
        </div>
    </div>
</footer>
<!-- endblock -->
            
        </div>

            <script>var base_url = '..';</script>
            <script src="../assets/js/jquery-3.3.1.slim.min.js""></script>
            <script src="../assets/js/bootstrap.bundle.min.js""></script>
            <script src="../assets/js/main.min.js""></script>
                <script src="../search/main.js" defer></script>

    </body>

</html>